<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Integration Examples | Haltian Developer Documentation</title><meta name=description content="Code samples for importing Parquet data into common analytics platforms"><meta property="og:url" content="https://developer.haltian.io/haltian-iot/apis/data-api/integration-examples/"><meta property="og:site_name" content="Haltian Developer Documentation"><meta property="og:title" content="Integration Examples"><meta property="og:description" content="Code samples for importing Parquet data into common analytics platforms"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="haltian-iot"><meta property="article:modified_time" content="2026-01-28T16:48:29+02:00"><meta itemprop=name content="Integration Examples"><meta itemprop=description content="Code samples for importing Parquet data into common analytics platforms"><meta itemprop=dateModified content="2026-01-28T16:48:29+02:00"><meta itemprop=wordCount content="687"><meta name=twitter:card content="summary"><meta name=twitter:title content="Integration Examples"><meta name=twitter:description content="Code samples for importing Parquet data into common analytics platforms"><link rel=preload href=/scss/main.min.d423c29d9765e7fa2af46a8f6237583add283e9337882d1b1c18b860d9bf357b.css as=style integrity="sha256-1CPCnZdl5/oq9GqPYjdYOt0oPpM3iC0bHBi4YNm/NXs=" crossorigin=anonymous><link href=/scss/main.min.d423c29d9765e7fa2af46a8f6237583add283e9337882d1b1c18b860d9bf357b.css rel=stylesheet integrity="sha256-1CPCnZdl5/oq9GqPYjdYOt0oPpM3iC0bHBi4YNm/NXs=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar navbar navbar-expand-lg navbar-dark bg-primary"><div class=container-fluid><a class=navbar-brand href=/><img src=https://developer.haltian.io/logo.png alt="Haltian Developer Documentation" height=28 class="d-inline-block align-top">
</a><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/haltian-iot/>Haltian IoT</a></li><li class=nav-item><a class=nav-link href=/thingsee-iot/>Thingsee IoT</a></li><li class=nav-item><a class=nav-link href=/devices/>Devices</a></li><li class=nav-item><a class=nav-link href=/faq/>FAQ</a></li></ul><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.00fa5d2135fb7948f0b1ab0185774bd9.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main data-bs-spy=scroll data-bs-target=.td-toc data-bs-root-margin="0px 0px -10%"><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><script>$(function(){$("#td-section-nav a").removeClass("active"),$("#td-section-nav #m-haltian-iotapisdata-apiintegration-examples").addClass("active"),$("#td-section-nav #m-haltian-iotapisdata-apiintegration-examples-li span").addClass("td-sidebar-nav-active-item"),$("#td-section-nav #m-haltian-iotapisdata-apiintegration-examples").parents("li").addClass("active-path"),$("#td-section-nav li.active-path").addClass("show"),$("#td-section-nav li.active-path").children("input").prop("checked",!0),$("#td-section-nav #m-haltian-iotapisdata-apiintegration-examples-li").siblings("li").addClass("show"),$("#td-section-nav #m-haltian-iotapisdata-apiintegration-examples-li").children("ul").children("li").addClass("show"),$("#td-sidebar-menu").toggleClass("d-none")})</script><div id=td-sidebar-menu class="td-sidebar__inner d-none"><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.00fa5d2135fb7948f0b1ab0185774bd9.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-haltian-iot-li><a href=/haltian-iot/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-haltian-iot><span>Haltian IoT</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-haltian-iotgetting-started-li><input type=checkbox id=m-haltian-iotgetting-started-check>
<label for=m-haltian-iotgetting-started-check><a href=/haltian-iot/getting-started/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-haltian-iotgetting-started><span>Getting Started</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotgetting-startedplatform-overview-li><input type=checkbox id=m-haltian-iotgetting-startedplatform-overview-check>
<label for=m-haltian-iotgetting-startedplatform-overview-check><a href=/haltian-iot/getting-started/platform-overview/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotgetting-startedplatform-overview><span>Platform Overview</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-haltian-iotconcepts-li><input type=checkbox id=m-haltian-iotconcepts-check>
<label for=m-haltian-iotconcepts-check><a href=/haltian-iot/concepts/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-haltian-iotconcepts><span>Concepts</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotconceptsroles-and-access-li><input type=checkbox id=m-haltian-iotconceptsroles-and-access-check>
<label for=m-haltian-iotconceptsroles-and-access-check><a href=/haltian-iot/concepts/roles-and-access/ title="Roles and Access Management" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotconceptsroles-and-access><span>Roles & Access</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotconceptsglossary-li><input type=checkbox id=m-haltian-iotconceptsglossary-check>
<label for=m-haltian-iotconceptsglossary-check><a href=/haltian-iot/concepts/glossary/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotconceptsglossary><span>Glossary</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-haltian-iotapis-li><input type=checkbox id=m-haltian-iotapis-check>
<label for=m-haltian-iotapis-check><a href=/haltian-iot/apis/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-haltian-iotapis><span>APIs</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-haltian-iotapisservice-api-li><input type=checkbox id=m-haltian-iotapisservice-api-check>
<label for=m-haltian-iotapisservice-api-check><a href=/haltian-iot/apis/service-api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-haltian-iotapisservice-api><span>Service API</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotapisservice-apiauthentication-li><input type=checkbox id=m-haltian-iotapisservice-apiauthentication-check>
<label for=m-haltian-iotapisservice-apiauthentication-check><a href=/haltian-iot/apis/service-api/authentication/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotapisservice-apiauthentication><span>Authentication</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotapisservice-apiqueries-li><input type=checkbox id=m-haltian-iotapisservice-apiqueries-check>
<label for=m-haltian-iotapisservice-apiqueries-check><a href=/haltian-iot/apis/service-api/queries/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotapisservice-apiqueries><span>Queries</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotapisservice-apimutations-li><input type=checkbox id=m-haltian-iotapisservice-apimutations-check>
<label for=m-haltian-iotapisservice-apimutations-check><a href=/haltian-iot/apis/service-api/mutations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotapisservice-apimutations><span>Mutations</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-haltian-iotapisstream-api-li><input type=checkbox id=m-haltian-iotapisstream-api-check>
<label for=m-haltian-iotapisstream-api-check><a href=/haltian-iot/apis/stream-api/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-haltian-iotapisstream-api><span>Stream API</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotapisstream-apitopics-li><input type=checkbox id=m-haltian-iotapisstream-apitopics-check>
<label for=m-haltian-iotapisstream-apitopics-check><a href=/haltian-iot/apis/stream-api/topics/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotapisstream-apitopics><span>Topics</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotapisstream-apiexamples-li><input type=checkbox id=m-haltian-iotapisstream-apiexamples-check>
<label for=m-haltian-iotapisstream-apiexamples-check><a href=/haltian-iot/apis/stream-api/examples/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotapisstream-apiexamples><span>Examples</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotapisstream-apicloud-binary-passthrough-li><input type=checkbox id=m-haltian-iotapisstream-apicloud-binary-passthrough-check>
<label for=m-haltian-iotapisstream-apicloud-binary-passthrough-check><a href=/haltian-iot/apis/stream-api/cloud-binary-passthrough/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotapisstream-apicloud-binary-passthrough><span>Cloud Binary Passthrough</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-haltian-iotapisdata-api-li><input type=checkbox id=m-haltian-iotapisdata-api-check>
<label for=m-haltian-iotapisdata-api-check><a href=/haltian-iot/apis/data-api/ title="Data API (Parquet)" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-haltian-iotapisdata-api><span>Data API</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotapisdata-apifolder-structure-li><input type=checkbox id=m-haltian-iotapisdata-apifolder-structure-check>
<label for=m-haltian-iotapisdata-apifolder-structure-check><a href=/haltian-iot/apis/data-api/folder-structure/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotapisdata-apifolder-structure><span>Folder Structure</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotapisdata-apischema-reference-li><input type=checkbox id=m-haltian-iotapisdata-apischema-reference-check>
<label for=m-haltian-iotapisdata-apischema-reference-check><a href=/haltian-iot/apis/data-api/schema-reference/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotapisdata-apischema-reference><span>Schema Reference</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotapisdata-apiintegration-examples-li><input type=checkbox id=m-haltian-iotapisdata-apiintegration-examples-check>
<label for=m-haltian-iotapisdata-apiintegration-examples-check><a href=/haltian-iot/apis/data-api/integration-examples/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotapisdata-apiintegration-examples><span>Integration Examples</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotapisdata-apiazure-integration-li><input type=checkbox id=m-haltian-iotapisdata-apiazure-integration-check>
<label for=m-haltian-iotapisdata-apiazure-integration-check><a href=/haltian-iot/apis/data-api/azure-integration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotapisdata-apiazure-integration><span>Azure Integration</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-haltian-iotapplications-li><input type=checkbox id=m-haltian-iotapplications-check>
<label for=m-haltian-iotapplications-check><a href=/haltian-iot/applications/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-haltian-iotapplications><span>Applications</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotapplicationsiot-studio-li><input type=checkbox id=m-haltian-iotapplicationsiot-studio-check>
<label for=m-haltian-iotapplicationsiot-studio-check><a href=/haltian-iot/applications/iot-studio/ title="Haltian IoT Studio" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotapplicationsiot-studio><span>IoT Studio</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-haltian-iotguides-li><input type=checkbox id=m-haltian-iotguides-check>
<label for=m-haltian-iotguides-check><a href=/haltian-iot/guides/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-haltian-iotguides><span>Guides</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotguidesmqtt-subscription-li><input type=checkbox id=m-haltian-iotguidesmqtt-subscription-check>
<label for=m-haltian-iotguidesmqtt-subscription-check><a href=/haltian-iot/guides/mqtt-subscription/ title="Subscribe to MQTT Data Stream" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotguidesmqtt-subscription><span>MQTT Subscription</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotguidesqr-code-identification-li><input type=checkbox id=m-haltian-iotguidesqr-code-identification-check>
<label for=m-haltian-iotguidesqr-code-identification-check><a href=/haltian-iot/guides/qr-code-identification/ title="Identify Device by QR Code" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotguidesqr-code-identification><span>QR Code Identification</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotguidesoccupancy-data-li><input type=checkbox id=m-haltian-iotguidesoccupancy-data-check>
<label for=m-haltian-iotguidesoccupancy-data-check><a href=/haltian-iot/guides/occupancy-data/ title="Working with Occupancy Data" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotguidesoccupancy-data><span>Occupancy Data</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotguidesposition-data-li><input type=checkbox id=m-haltian-iotguidesposition-data-check>
<label for=m-haltian-iotguidesposition-data-check><a href=/haltian-iot/guides/position-data/ title="Position Data Best Practices" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotguidesposition-data><span>Position Data</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotguidesmeasurement-types-li><input type=checkbox id=m-haltian-iotguidesmeasurement-types-check>
<label for=m-haltian-iotguidesmeasurement-types-check><a href=/haltian-iot/guides/measurement-types/ title="Measurement Types Reference" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotguidesmeasurement-types><span>Measurement Types</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-haltian-iotintegrations-li><input type=checkbox id=m-haltian-iotintegrations-check>
<label for=m-haltian-iotintegrations-check><a href=/haltian-iot/integrations/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-haltian-iotintegrations><span>Integrations</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotintegrationsmicrosoft-places-li><input type=checkbox id=m-haltian-iotintegrationsmicrosoft-places-check>
<label for=m-haltian-iotintegrationsmicrosoft-places-check><a href=/haltian-iot/integrations/microsoft-places/ title="Microsoft Places Integration" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotintegrationsmicrosoft-places><span>Microsoft Places</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotintegrationsthingsboard-li><input type=checkbox id=m-haltian-iotintegrationsthingsboard-check>
<label for=m-haltian-iotintegrationsthingsboard-check><a href=/haltian-iot/integrations/thingsboard/ title="ThingsBoard Integration" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-haltian-iotintegrationsthingsboard><span>ThingsBoard</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-haltian-iotreference-li><input type=checkbox id=m-haltian-iotreference-check>
<label for=m-haltian-iotreference-check><a href=/haltian-iot/reference/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-haltian-iotreference><span>Reference</span></a></label></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"></div><div class=td-toc data-proofer-ignore><div class=td-toc-title><span class=td-toc-title__text>On this page</span>
<a class=td-toc-title__link title="Top of page" href=#></a></div><nav id=TableOfContents><ul><li><a href=#python-with-pandas>Python with Pandas</a></li><li><a href=#python-with-pyarrow>Python with PyArrow</a></li><li><a href=#duckdb>DuckDB</a></li><li><a href=#aws-s3-direct-access>AWS S3 Direct Access</a><ul><li><a href=#python-with-boto3>Python with boto3</a></li><li><a href=#pyarrow-with-s3-filesystem>PyArrow with S3 filesystem</a></li></ul></li><li><a href=#databricks>Databricks</a><ul><li><a href=#sql>SQL</a></li><li><a href=#python-pyspark>Python (PySpark)</a></li></ul></li><li><a href=#snowflake>Snowflake</a><ul><li><a href=#create-external-stage>Create external stage</a></li><li><a href=#query-staged-files>Query staged files</a></li><li><a href=#load-into-table>Load into table</a></li></ul></li><li><a href=#google-bigquery>Google BigQuery</a><ul><li><a href=#load-from-cloud-storage>Load from Cloud Storage</a></li><li><a href=#external-table>External table</a></li></ul></li><li><a href=#apache-spark>Apache Spark</a></li><li><a href=#clickhouse>ClickHouse</a></li><li><a href=#power-bi>Power BI</a><ul><li><a href=#using-python-script>Using Python script</a></li><li><a href=#using-azure-synapse-connector>Using Azure Synapse connector</a></li></ul></li><li><a href=#common-patterns>Common Patterns</a><ul><li><a href=#incremental-loading>Incremental Loading</a></li><li><a href=#joining-entity-and-measurement-data>Joining Entity and Measurement Data</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/haltian-iot/>Haltian IoT</a></li><li class=breadcrumb-item><a href=/haltian-iot/apis/>APIs</a></li><li class=breadcrumb-item><a href=/haltian-iot/apis/data-api/>Data API</a></li><li class="breadcrumb-item active" aria-current=page>Integration Examples</li></ol></nav><div class=td-content><h1>Integration Examples</h1><div class=lead>Code samples for importing Parquet data into common analytics platforms</div><header class=article-meta></header><h2 id=python-with-pandas>Python with Pandas</h2><p>Read Parquet files directly into pandas DataFrames:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>pandas</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>pd</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Read a single file</span>
</span></span><span style=display:flex><span><span style=color:#000>df</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>pd</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read_parquet</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;device/2026/01/2026_01_28_08_device.parquet&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Read all files in a directory</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>glob</span>
</span></span><span style=display:flex><span><span style=color:#000>files</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>glob</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>glob</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;measurementOccupancyStatus/2026/01/*.parquet&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>df</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>pd</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>concat</span><span style=color:#000;font-weight:700>([</span><span style=color:#000>pd</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read_parquet</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>f</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>f</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>files</span><span style=color:#000;font-weight:700>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Filter by time range</span>
</span></span><span style=display:flex><span><span style=color:#000>df_filtered</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>df</span><span style=color:#000;font-weight:700>[(</span><span style=color:#000>df</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;ts&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>&gt;=</span> <span style=color:#4e9a06>&#39;2026-01-01&#39;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>&amp;</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>df</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;ts&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#4e9a06>&#39;2026-02-01&#39;</span><span style=color:#000;font-weight:700>)]</span>
</span></span></code></pre></div><h2 id=python-with-pyarrow>Python with PyArrow</h2><p>For better performance with large datasets:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>pyarrow.parquet</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>pq</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Read with column selection</span>
</span></span><span style=display:flex><span><span style=color:#000>table</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>pq</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read_table</span><span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#39;measurementAmbientTemperature/2026/01/&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>columns</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;deviceId&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;ts&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;ambientTemperature&#39;</span><span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Convert to pandas</span>
</span></span><span style=display:flex><span><span style=color:#000>df</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>table</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>to_pandas</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Read with row filtering (predicate pushdown)</span>
</span></span><span style=display:flex><span><span style=color:#000>table</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>pq</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read_table</span><span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#39;device/2026/01/&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>filters</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000;font-weight:700>[(</span><span style=color:#4e9a06>&#39;installationStatus&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;=&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;installed&#39;</span><span style=color:#000;font-weight:700>)]</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h2 id=duckdb>DuckDB</h2><p>Query Parquet files directly with SQL:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>duckdb</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Query files with SQL</span>
</span></span><span style=display:flex><span><span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>duckdb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>query</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    SELECT 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        deviceId,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        DATE_TRUNC(&#39;hour&#39;, ts) as hour,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        AVG(ambientTemperature) as avg_temp
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    FROM &#39;measurementAmbientTemperature/2026/01/*.parquet&#39;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    GROUP BY deviceId, DATE_TRUNC(&#39;hour&#39;, ts)
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    ORDER BY hour
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;&#34;&#34;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>df</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Join multiple entity types</span>
</span></span><span style=display:flex><span><span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>duckdb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>query</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    SELECT 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        d.name as device_name,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        m.ts,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        m.status
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    FROM &#39;measurementOccupancyStatus/2026/01/*.parquet&#39; m
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    JOIN &#39;device/2026/01/*.parquet&#39; d ON m.deviceId = d.id
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    WHERE m.status = 1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;&#34;&#34;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>df</span><span style=color:#000;font-weight:700>()</span>
</span></span></code></pre></div><h2 id=aws-s3-direct-access>AWS S3 Direct Access</h2><h3 id=python-with-boto3>Python with boto3</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>boto3</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>pandas</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>pd</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>io</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>BytesIO</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>s3</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>boto3</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>client</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;s3&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>aws_access_key_id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;YOUR_ACCESS_KEY&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>aws_secret_access_key</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;YOUR_SECRET_KEY&#39;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>bucket</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;your-bucket&#39;</span>
</span></span><span style=display:flex><span><span style=color:#000>key</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;downloads/parquet/{org-id}/device/2026/01/2026_01_28_08_device.parquet&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>response</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>s3</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>get_object</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Bucket</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>bucket</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Key</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>key</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>df</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>pd</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read_parquet</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>BytesIO</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>response</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;Body&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read</span><span style=color:#000;font-weight:700>()))</span>
</span></span></code></pre></div><h3 id=pyarrow-with-s3-filesystem>PyArrow with S3 filesystem</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>pyarrow.parquet</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>pq</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>pyarrow</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>fs</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>s3</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>fs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>S3FileSystem</span><span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#000>access_key</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;YOUR_ACCESS_KEY&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>secret_key</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;YOUR_SECRET_KEY&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>region</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;eu-west-1&#39;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Read directly from S3</span>
</span></span><span style=display:flex><span><span style=color:#000>table</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>pq</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read_table</span><span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#39;your-bucket/downloads/parquet/{org-id}/device/2026/01/&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>filesystem</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>s3</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h2 id=databricks>Databricks</h2><h3 id=sql>SQL</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Create external table pointing to S3
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>IF</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>NOT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>EXISTS</span><span style=color:#f8f8f8> </span><span style=color:#000>haltian_devices</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>USING</span><span style=color:#f8f8f8> </span><span style=color:#000>PARQUET</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>LOCATION</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;s3://your-bucket/downloads/parquet/{org-id}/device/&#39;</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Query the data
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#000>haltian_devices</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>WHERE</span><span style=color:#f8f8f8> </span><span style=color:#000>installationStatus</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;installed&#39;</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=python-pyspark>Python (PySpark)</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Read from S3</span>
</span></span><span style=display:flex><span><span style=color:#000>df</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>spark</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>parquet</span><span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;s3://your-bucket/downloads/parquet/{org-id}/measurementOccupancyStatus/&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Filter and aggregate</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>pyspark.sql.functions</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>date_trunc</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>avg</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>hourly_occupancy</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>df</span> \
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>groupBy</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;deviceId&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>date_trunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;hour&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ts&#34;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>alias</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;hour&#34;</span><span style=color:#000;font-weight:700>))</span> \
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>agg</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>avg</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;status&#34;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>alias</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;occupancy_rate&#34;</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><h2 id=snowflake>Snowflake</h2><h3 id=create-external-stage>Create external stage</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>OR</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>REPLACE</span><span style=color:#f8f8f8> </span><span style=color:#000>STAGE</span><span style=color:#f8f8f8> </span><span style=color:#000>haltian_parquet</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>URL</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;s3://your-bucket/downloads/parquet/{org-id}/&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>CREDENTIALS</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>AWS_KEY_ID</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;...&#39;</span><span style=color:#f8f8f8> </span><span style=color:#000>AWS_SECRET_KEY</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;...&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>FILE_FORMAT</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>TYPE</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#000>PARQUET</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=query-staged-files>Query staged files</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> 
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#a40000>$</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#000>deviceId</span><span style=color:#000;font-weight:700>::</span><span style=color:#000>STRING</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>as</span><span style=color:#f8f8f8> </span><span style=color:#000>device_id</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#a40000>$</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#000>ts</span><span style=color:#000;font-weight:700>::</span><span style=color:#204a87;font-weight:700>TIMESTAMP</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>as</span><span style=color:#f8f8f8> </span><span style=color:#000>measurement_time</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#a40000>$</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#000>ambientTemperature</span><span style=color:#000;font-weight:700>::</span><span style=color:#204a87>FLOAT</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>as</span><span style=color:#f8f8f8> </span><span style=color:#000>temperature</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>@</span><span style=color:#000>haltian_parquet</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>measurementAmbientTemperature</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#0000cf;font-weight:700>2026</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#0000cf;font-weight:700>01</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>(</span><span style=color:#000>FILE_FORMAT</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;PARQUET&#39;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=load-into-table>Load into table</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>measurement_temperature</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>device_id</span><span style=color:#f8f8f8> </span><span style=color:#000>STRING</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>ts</span><span style=color:#f8f8f8> </span><span style=color:#000>TIMESTAMP_NTZ</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>ambient_temperature</span><span style=color:#f8f8f8> </span><span style=color:#204a87>FLOAT</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>organization_id</span><span style=color:#f8f8f8> </span><span style=color:#000>STRING</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>COPY</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>INTO</span><span style=color:#f8f8f8> </span><span style=color:#000>measurement_temperature</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>@</span><span style=color:#000>haltian_parquet</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>measurementAmbientTemperature</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>FILE_FORMAT</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>TYPE</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#000>PARQUET</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>MATCH_BY_COLUMN_NAME</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#000>CASE_INSENSITIVE</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h2 id=google-bigquery>Google BigQuery</h2><h3 id=load-from-cloud-storage>Load from Cloud Storage</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>LOAD</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>DATA</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>INTO</span><span style=color:#f8f8f8> </span><span style=color:#000>mydataset</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>devices</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#000>FILES</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>format</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;PARQUET&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>uris</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;gs://your-bucket/downloads/parquet/{org-id}/device/2026/01/*.parquet&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=external-table>External table</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>EXTERNAL</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>mydataset</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>measurements</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>OPTIONS</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>format</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#4e9a06>&#39;PARQUET&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>uris</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;gs://your-bucket/downloads/parquet/{org-id}/measurementOccupancyStatus/*/*.parquet&#39;</span><span style=color:#000;font-weight:700>]</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h2 id=apache-spark>Apache Spark</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Scala
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>val</span> <span style=color:#000>devices</span> <span style=color:#204a87;font-weight:700>=</span> <span style=color:#000>spark</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>parquet</span><span style=color:#ce5c00;font-weight:700>(</span>
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;s3a://your-bucket/downloads/parquet/{org-id}/device/&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>val</span> <span style=color:#000>measurements</span> <span style=color:#204a87;font-weight:700>=</span> <span style=color:#000>spark</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>parquet</span><span style=color:#ce5c00;font-weight:700>(</span>
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#34;s3a://your-bucket/downloads/parquet/{org-id}/measurementOccupancyStatus/&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Join and analyze
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>val</span> <span style=color:#000>result</span> <span style=color:#204a87;font-weight:700>=</span> <span style=color:#000>measurements</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>join</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>devices</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>measurements</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;deviceId&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>===</span> <span style=color:#000>devices</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>groupBy</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>devices</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>),</span> <span style=color:#000>date_trunc</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;day&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>measurements</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;ts&#34;</span><span style=color:#ce5c00;font-weight:700>)))</span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>agg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>avg</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;status&#34;</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#000>as</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;daily_occupancy_rate&#34;</span><span style=color:#ce5c00;font-weight:700>))</span>
</span></span></code></pre></div><h2 id=clickhouse>ClickHouse</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Query S3 directly
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> 
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>deviceId</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>toStartOfHour</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ts</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>hour</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#204a87;font-weight:700>avg</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ambientTemperature</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#000>avg_temp</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#000>s3</span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#4e9a06>&#39;https://your-bucket.s3.amazonaws.com/downloads/parquet/{org-id}/measurementAmbientTemperature/2026/01/*.parquet&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#4e9a06>&#39;AWS_ACCESS_KEY&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#4e9a06>&#39;AWS_SECRET_KEY&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#4e9a06>&#39;Parquet&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>GROUP</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>BY</span><span style=color:#f8f8f8> </span><span style=color:#000>deviceId</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8> </span><span style=color:#000>hour</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>ORDER</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>BY</span><span style=color:#f8f8f8> </span><span style=color:#000>hour</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>-- Create table from Parquet
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>CREATE</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>TABLE</span><span style=color:#f8f8f8> </span><span style=color:#000>devices</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000>ENGINE</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#f8f8f8> </span><span style=color:#000>MergeTree</span><span style=color:#000;font-weight:700>()</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>ORDER</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>BY</span><span style=color:#f8f8f8> </span><span style=color:#000>id</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>AS</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>SELECT</span><span style=color:#f8f8f8> </span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#f8f8f8> </span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#f8f8f8> </span><span style=color:#000>s3</span><span style=color:#000;font-weight:700>(</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#4e9a06>&#39;https://your-bucket.s3.amazonaws.com/downloads/parquet/{org-id}/device/2026/01/*.parquet&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#4e9a06>&#39;AWS_ACCESS_KEY&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#4e9a06>&#39;AWS_SECRET_KEY&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#4e9a06>&#39;Parquet&#39;</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h2 id=power-bi>Power BI</h2><h3 id=using-python-script>Using Python script</h3><ol><li>In Power BI Desktop, select <strong>Get Data</strong> → <strong>Python script</strong></li><li>Use this script:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>pandas</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>pd</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>glob</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Update path to your downloaded files</span>
</span></span><span style=display:flex><span><span style=color:#000>path</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;C:/data/haltian/measurementOccupancyStatus/2026/01/*.parquet&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000>df</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>pd</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>concat</span><span style=color:#000;font-weight:700>([</span><span style=color:#000>pd</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>read_parquet</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>f</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>f</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>glob</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>glob</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>path</span><span style=color:#000;font-weight:700>)])</span>
</span></span></code></pre></div><h3 id=using-azure-synapse-connector>Using Azure Synapse connector</h3><p>If you&rsquo;ve imported data into Azure Synapse, use the native Synapse connector for best performance.</p><h2 id=common-patterns>Common Patterns</h2><h3 id=incremental-loading>Incremental Loading</h3><p>Track the latest processed file to avoid reprocessing:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>os</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>datetime</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>datetime</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>def</span> <span style=color:#000>get_new_files</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>base_path</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>last_processed_time</span><span style=color:#000;font-weight:700>):</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;&#34;&#34;Find files newer than last processed timestamp.&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>new_files</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[]</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>root</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>dirs</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>files</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>walk</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>base_path</span><span style=color:#000;font-weight:700>):</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>file</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>files</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>endswith</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;.parquet&#39;</span><span style=color:#000;font-weight:700>):</span>
</span></span><span style=display:flex><span>                <span style=color:#000>filepath</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>path</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>join</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>root</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>file</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>                <span style=color:#8f5902;font-style:italic># Parse timestamp from filename: YYYY_MM_DD_HH_entity.parquet</span>
</span></span><span style=display:flex><span>                <span style=color:#000>parts</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>split</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;_&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>                <span style=color:#000>file_time</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>datetime</span><span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87>int</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>parts</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]),</span> <span style=color:#204a87>int</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>parts</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]),</span> 
</span></span><span style=display:flex><span>                    <span style=color:#204a87>int</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>parts</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>]),</span> <span style=color:#204a87>int</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>parts</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>])</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>file_time</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>last_processed_time</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>new_files</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>append</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>filepath</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87>sorted</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>new_files</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h3 id=joining-entity-and-measurement-data>Joining Entity and Measurement Data</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>duckdb</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Get device details with their latest temperature readings</span>
</span></span><span style=display:flex><span><span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>duckdb</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>query</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    WITH latest_temps AS (
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        SELECT 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            deviceId,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            ts,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            ambientTemperature,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            ROW_NUMBER() OVER (PARTITION BY deviceId ORDER BY ts DESC) as rn
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        FROM &#39;measurementAmbientTemperature/2026/01/*.parquet&#39;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    )
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    SELECT 
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        d.id,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        d.name,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        d.model,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        t.ts as last_reading_time,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        t.ambientTemperature as last_temperature
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    FROM &#39;device/2026/01/*.parquet&#39; d
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    LEFT JOIN latest_temps t ON d.id = t.deviceId AND t.rn = 1
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    WHERE d.installationStatus = &#39;installed&#39;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>&#34;&#34;&#34;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>df</span><span style=color:#000;font-weight:700>()</span>
</span></span></code></pre></div></div></main></div></div><footer class="td-footer bg-dark"><div class="container py-4"><div class=row><div class="col-12 col-md-6 text-center text-md-left"><div class=td-footer__left><span class=text-white>&copy; 2026 Haltian |
<a href=https://haltian.com/privacy class=text-white>Privacy Policy</a></span></div></div><div class="col-12 col-md-6 text-center text-md-right"><div class=td-footer__right><a class="text-white mx-2" target=_blank rel=noopener href=mailto:support@haltian.com aria-label="Contact Support"><i class="fa fa-envelope"></i>
</a><a class="text-white mx-2" target=_blank rel=noopener href=https://haltian.com aria-label="Haltian Website"><i class="fa fa-globe"></i>
</a><a class="text-white mx-2" target=_blank rel=noopener href=https://github.com/haltian aria-label=GitHub><i class="fab fa-github"></i></a></div></div></div></div></footer></div><script src=/js/main.min.8dd4d36f10f64ef5224e04ba313f8e91e183feca404406187e7d4bad9bc83b21.js integrity="sha256-jdTTbxD2TvUiTgS6MT+OkeGD/spARAYYfn1LrZvIOyE=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>