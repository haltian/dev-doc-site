<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=https://haltian.github.io/dev-doc-site/favicons/favicon.ico><link rel=apple-touch-icon href=https://haltian.github.io/dev-doc-site/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=https://haltian.github.io/dev-doc-site/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=https://haltian.github.io/dev-doc-site/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://haltian.github.io/dev-doc-site/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=https://haltian.github.io/dev-doc-site/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=https://haltian.github.io/dev-doc-site/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=https://haltian.github.io/dev-doc-site/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=https://haltian.github.io/dev-doc-site/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=https://haltian.github.io/dev-doc-site/favicons/android-192x192.png sizes=192x192><title>Thingsee CBOR to JSON Conversion | Haltian Developer Documentation</title><meta name=description content="Complete guide for converting Thingsee CBOR binary messages to JSON format"><meta property="og:url" content="https://haltian.github.io/dev-doc-site/devices/technical-reference/cbor-json-conversion/"><meta property="og:site_name" content="Haltian Developer Documentation"><meta property="og:title" content="Thingsee CBOR to JSON Conversion"><meta property="og:description" content="Complete guide for converting Thingsee CBOR binary messages to JSON format"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="devices"><meta property="article:modified_time" content="2026-01-28T18:09:47+02:00"><meta itemprop=name content="Thingsee CBOR to JSON Conversion"><meta itemprop=description content="Complete guide for converting Thingsee CBOR binary messages to JSON format"><meta itemprop=dateModified content="2026-01-28T18:09:47+02:00"><meta itemprop=wordCount content="3457"><meta name=twitter:card content="summary"><meta name=twitter:title content="Thingsee CBOR to JSON Conversion"><meta name=twitter:description content="Complete guide for converting Thingsee CBOR binary messages to JSON format"><link rel=preload href=https://haltian.github.io/dev-doc-site/scss/main.min.d423c29d9765e7fa2af46a8f6237583add283e9337882d1b1c18b860d9bf357b.css as=style integrity="sha256-1CPCnZdl5/oq9GqPYjdYOt0oPpM3iC0bHBi4YNm/NXs=" crossorigin=anonymous><link href=https://haltian.github.io/dev-doc-site/scss/main.min.d423c29d9765e7fa2af46a8f6237583add283e9337882d1b1c18b860d9bf357b.css rel=stylesheet integrity="sha256-1CPCnZdl5/oq9GqPYjdYOt0oPpM3iC0bHBi4YNm/NXs=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar navbar navbar-expand-lg navbar-dark bg-primary"><div class=container-fluid><a class=navbar-brand href=https://haltian.github.io/dev-doc-site/><img src=https://haltian.github.io/dev-doc-site/logo.png alt="Haltian Developer Documentation" height=28 class="d-inline-block align-top">
</a><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://haltian.github.io/dev-doc-site/haltian-iot/>Haltian IoT</a></li><li class=nav-item><a class=nav-link href=https://haltian.github.io/dev-doc-site/thingsee-iot/>Thingsee IoT</a></li><li class=nav-item><a class=nav-link href=https://haltian.github.io/dev-doc-site/devices/>Devices</a></li><li class=nav-item><a class=nav-link href=https://haltian.github.io/dev-doc-site/faq/>FAQ</a></li></ul><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=https://haltian.github.io/dev-doc-site/offline-search-index.83bdb4691ad35a13b29673f4b4164374.json data-offline-search-base-href=https://haltian.github.io/dev-doc-site/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main data-bs-spy=scroll data-bs-target=.td-toc data-bs-root-margin="0px 0px -10%"><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><script>$(function(){$("#td-section-nav a").removeClass("active"),$("#td-section-nav #m-devicestechnical-referencecbor-json-conversion").addClass("active"),$("#td-section-nav #m-devicestechnical-referencecbor-json-conversion-li span").addClass("td-sidebar-nav-active-item"),$("#td-section-nav #m-devicestechnical-referencecbor-json-conversion").parents("li").addClass("active-path"),$("#td-section-nav li.active-path").addClass("show"),$("#td-section-nav li.active-path").children("input").prop("checked",!0),$("#td-section-nav #m-devicestechnical-referencecbor-json-conversion-li").siblings("li").addClass("show"),$("#td-section-nav #m-devicestechnical-referencecbor-json-conversion-li").children("ul").children("li").addClass("show"),$("#td-sidebar-menu").toggleClass("d-none")})</script><div id=td-sidebar-menu class="td-sidebar__inner d-none"><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=https://haltian.github.io/dev-doc-site/offline-search-index.83bdb4691ad35a13b29673f4b4164374.json data-offline-search-base-href=https://haltian.github.io/dev-doc-site/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devices-li><a href=https://haltian.github.io/dev-doc-site/devices/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-devices><span>Devices</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicessensors-li><input type=checkbox id=m-devicessensors-check>
<label for=m-devicessensors-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicessensors><span>Sensors</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicessensorsthingsee-presence-li><input type=checkbox id=m-devicessensorsthingsee-presence-check>
<label for=m-devicessensorsthingsee-presence-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-presence/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicessensorsthingsee-presence><span>Thingsee PRESENCE</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-presenceinstallation-li><input type=checkbox id=m-devicessensorsthingsee-presenceinstallation-check>
<label for=m-devicessensorsthingsee-presenceinstallation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-presence/installation/ title="Installation Guide" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-presenceinstallation><span>Installation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-presenceconfiguration-li><input type=checkbox id=m-devicessensorsthingsee-presenceconfiguration-check>
<label for=m-devicessensorsthingsee-presenceconfiguration-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-presence/configuration/ title="Thingsee PRESENCE Configuration" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-presenceconfiguration><span>Configuration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-presenceoperation-li><input type=checkbox id=m-devicessensorsthingsee-presenceoperation-check>
<label for=m-devicessensorsthingsee-presenceoperation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-presence/operation/ title="Operation Guide" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-presenceoperation><span>Operation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-presencespecifications-li><input type=checkbox id=m-devicessensorsthingsee-presencespecifications-check>
<label for=m-devicessensorsthingsee-presencespecifications-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-presence/specifications/ title="Technical Specifications" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-presencespecifications><span>Specifications</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-presencetroubleshooting-li><input type=checkbox id=m-devicessensorsthingsee-presencetroubleshooting-check>
<label for=m-devicessensorsthingsee-presencetroubleshooting-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-presence/troubleshooting/ title="Troubleshooting & Maintenance" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-presencetroubleshooting><span>Troubleshooting</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicessensorsthingsee-air-li><input type=checkbox id=m-devicessensorsthingsee-air-check>
<label for=m-devicessensorsthingsee-air-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-air/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicessensorsthingsee-air><span>Thingsee AIR</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-airinstallation-li><input type=checkbox id=m-devicessensorsthingsee-airinstallation-check>
<label for=m-devicessensorsthingsee-airinstallation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-air/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-airinstallation><span>Installation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-airoperation-li><input type=checkbox id=m-devicessensorsthingsee-airoperation-check>
<label for=m-devicessensorsthingsee-airoperation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-air/operation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-airoperation><span>Operation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-airconfiguration-li><input type=checkbox id=m-devicessensorsthingsee-airconfiguration-check>
<label for=m-devicessensorsthingsee-airconfiguration-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-air/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-airconfiguration><span>Configuration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-airspecifications-li><input type=checkbox id=m-devicessensorsthingsee-airspecifications-check>
<label for=m-devicessensorsthingsee-airspecifications-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-air/specifications/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-airspecifications><span>Specifications</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-airtroubleshooting-li><input type=checkbox id=m-devicessensorsthingsee-airtroubleshooting-check>
<label for=m-devicessensorsthingsee-airtroubleshooting-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-air/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-airtroubleshooting><span>Troubleshooting</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicessensorsthingsee-environment-li><input type=checkbox id=m-devicessensorsthingsee-environment-check>
<label for=m-devicessensorsthingsee-environment-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-environment/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicessensorsthingsee-environment><span>Thingsee ENVIRONMENT</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-environmentinstallation-li><input type=checkbox id=m-devicessensorsthingsee-environmentinstallation-check>
<label for=m-devicessensorsthingsee-environmentinstallation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-environment/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-environmentinstallation><span>Installation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-environmentoperation-li><input type=checkbox id=m-devicessensorsthingsee-environmentoperation-check>
<label for=m-devicessensorsthingsee-environmentoperation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-environment/operation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-environmentoperation><span>Operation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-environmentconfiguration-li><input type=checkbox id=m-devicessensorsthingsee-environmentconfiguration-check>
<label for=m-devicessensorsthingsee-environmentconfiguration-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-environment/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-environmentconfiguration><span>Configuration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-environmentspecifications-li><input type=checkbox id=m-devicessensorsthingsee-environmentspecifications-check>
<label for=m-devicessensorsthingsee-environmentspecifications-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-environment/specifications/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-environmentspecifications><span>Specifications</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-environmenttroubleshooting-li><input type=checkbox id=m-devicessensorsthingsee-environmenttroubleshooting-check>
<label for=m-devicessensorsthingsee-environmenttroubleshooting-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-environment/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-environmenttroubleshooting><span>Troubleshooting</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicessensorshaltian-radar-li><input type=checkbox id=m-devicessensorshaltian-radar-check>
<label for=m-devicessensorshaltian-radar-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/haltian-radar/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicessensorshaltian-radar><span>Haltian RADAR</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorshaltian-radarinstallation-li><input type=checkbox id=m-devicessensorshaltian-radarinstallation-check>
<label for=m-devicessensorshaltian-radarinstallation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/haltian-radar/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorshaltian-radarinstallation><span>Installation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorshaltian-radaroperation-li><input type=checkbox id=m-devicessensorshaltian-radaroperation-check>
<label for=m-devicessensorshaltian-radaroperation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/haltian-radar/operation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorshaltian-radaroperation><span>Operation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorshaltian-radarconfiguration-li><input type=checkbox id=m-devicessensorshaltian-radarconfiguration-check>
<label for=m-devicessensorshaltian-radarconfiguration-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/haltian-radar/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorshaltian-radarconfiguration><span>Configuration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorshaltian-radarspecifications-li><input type=checkbox id=m-devicessensorshaltian-radarspecifications-check>
<label for=m-devicessensorshaltian-radarspecifications-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/haltian-radar/specifications/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorshaltian-radarspecifications><span>Specifications</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorshaltian-radartroubleshooting-li><input type=checkbox id=m-devicessensorshaltian-radartroubleshooting-check>
<label for=m-devicessensorshaltian-radartroubleshooting-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/haltian-radar/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorshaltian-radartroubleshooting><span>Troubleshooting</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicessensorsthingsee-count-li><input type=checkbox id=m-devicessensorsthingsee-count-check>
<label for=m-devicessensorsthingsee-count-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-count/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicessensorsthingsee-count><span>Thingsee COUNT</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-countinstallation-li><input type=checkbox id=m-devicessensorsthingsee-countinstallation-check>
<label for=m-devicessensorsthingsee-countinstallation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-count/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-countinstallation><span>Installation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-countoperation-li><input type=checkbox id=m-devicessensorsthingsee-countoperation-check>
<label for=m-devicessensorsthingsee-countoperation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-count/operation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-countoperation><span>Operation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-countconfiguration-li><input type=checkbox id=m-devicessensorsthingsee-countconfiguration-check>
<label for=m-devicessensorsthingsee-countconfiguration-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-count/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-countconfiguration><span>Configuration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-countspecifications-li><input type=checkbox id=m-devicessensorsthingsee-countspecifications-check>
<label for=m-devicessensorsthingsee-countspecifications-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-count/specifications/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-countspecifications><span>Specifications</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-counttroubleshooting-li><input type=checkbox id=m-devicessensorsthingsee-counttroubleshooting-check>
<label for=m-devicessensorsthingsee-counttroubleshooting-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-count/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-counttroubleshooting><span>Troubleshooting</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicessensorsthingsee-environment-rugged-li><input type=checkbox id=m-devicessensorsthingsee-environment-rugged-check>
<label for=m-devicessensorsthingsee-environment-rugged-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-environment-rugged/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicessensorsthingsee-environment-rugged><span>Thingsee ENVIRONMENT RUGGED</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-environment-ruggedinstallation-li><input type=checkbox id=m-devicessensorsthingsee-environment-ruggedinstallation-check>
<label for=m-devicessensorsthingsee-environment-ruggedinstallation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-environment-rugged/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-environment-ruggedinstallation><span>Installation</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-beam-li><input type=checkbox id=m-devicessensorsthingsee-beam-check>
<label for=m-devicessensorsthingsee-beam-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-beam/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicessensorsthingsee-beam><span>Thingsee BEAM</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicessensorsthingsee-leakage-rugged-li><input type=checkbox id=m-devicessensorsthingsee-leakage-rugged-check>
<label for=m-devicessensorsthingsee-leakage-rugged-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-leakage-rugged/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicessensorsthingsee-leakage-rugged><span>Thingsee LEAKAGE RUGGED</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicessensorsthingsee-leakage-ruggedinstallation-li><input type=checkbox id=m-devicessensorsthingsee-leakage-ruggedinstallation-check>
<label for=m-devicessensorsthingsee-leakage-ruggedinstallation-check><a href=https://haltian.github.io/dev-doc-site/devices/sensors/thingsee-leakage-rugged/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicessensorsthingsee-leakage-ruggedinstallation><span>Installation</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicesgateways-li><input type=checkbox id=m-devicesgateways-check>
<label for=m-devicesgateways-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicesgateways><span>Gateways</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicesgatewayshaltian-iot-gateway-n8-li><input type=checkbox id=m-devicesgatewayshaltian-iot-gateway-n8-check>
<label for=m-devicesgatewayshaltian-iot-gateway-n8-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/haltian-iot-gateway-n8/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicesgatewayshaltian-iot-gateway-n8><span>Haltian IoT Gateway N8</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesgatewayshaltian-iot-gateway-n8installation-li><input type=checkbox id=m-devicesgatewayshaltian-iot-gateway-n8installation-check>
<label for=m-devicesgatewayshaltian-iot-gateway-n8installation-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/haltian-iot-gateway-n8/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesgatewayshaltian-iot-gateway-n8installation><span>Installation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesgatewayshaltian-iot-gateway-n8configuration-li><input type=checkbox id=m-devicesgatewayshaltian-iot-gateway-n8configuration-check>
<label for=m-devicesgatewayshaltian-iot-gateway-n8configuration-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/haltian-iot-gateway-n8/configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesgatewayshaltian-iot-gateway-n8configuration><span>Configuration</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesgatewayshaltian-iot-gateway-n8operation-li><input type=checkbox id=m-devicesgatewayshaltian-iot-gateway-n8operation-check>
<label for=m-devicesgatewayshaltian-iot-gateway-n8operation-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/haltian-iot-gateway-n8/operation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesgatewayshaltian-iot-gateway-n8operation><span>Operation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesgatewayshaltian-iot-gateway-n8specifications-li><input type=checkbox id=m-devicesgatewayshaltian-iot-gateway-n8specifications-check>
<label for=m-devicesgatewayshaltian-iot-gateway-n8specifications-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/haltian-iot-gateway-n8/specifications/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesgatewayshaltian-iot-gateway-n8specifications><span>Specifications</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesgatewayshaltian-iot-gateway-n8troubleshooting-li><input type=checkbox id=m-devicesgatewayshaltian-iot-gateway-n8troubleshooting-check>
<label for=m-devicesgatewayshaltian-iot-gateway-n8troubleshooting-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/haltian-iot-gateway-n8/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesgatewayshaltian-iot-gateway-n8troubleshooting><span>Troubleshooting</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicesgatewaysthingsee-gateway-global-li><input type=checkbox id=m-devicesgatewaysthingsee-gateway-global-check>
<label for=m-devicesgatewaysthingsee-gateway-global-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/thingsee-gateway-global/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicesgatewaysthingsee-gateway-global><span>Thingsee Gateway Global</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesgatewaysthingsee-gateway-globalinstallation-li><input type=checkbox id=m-devicesgatewaysthingsee-gateway-globalinstallation-check>
<label for=m-devicesgatewaysthingsee-gateway-globalinstallation-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/thingsee-gateway-global/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesgatewaysthingsee-gateway-globalinstallation><span>Installation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesgatewaysthingsee-gateway-globaloperation-li><input type=checkbox id=m-devicesgatewaysthingsee-gateway-globaloperation-check>
<label for=m-devicesgatewaysthingsee-gateway-globaloperation-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/thingsee-gateway-global/operation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesgatewaysthingsee-gateway-globaloperation><span>Operation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesgatewaysthingsee-gateway-globalspecifications-li><input type=checkbox id=m-devicesgatewaysthingsee-gateway-globalspecifications-check>
<label for=m-devicesgatewaysthingsee-gateway-globalspecifications-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/thingsee-gateway-global/specifications/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesgatewaysthingsee-gateway-globalspecifications><span>Specifications</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesgatewaysthingsee-gateway-globaltroubleshooting-li><input type=checkbox id=m-devicesgatewaysthingsee-gateway-globaltroubleshooting-check>
<label for=m-devicesgatewaysthingsee-gateway-globaltroubleshooting-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/thingsee-gateway-global/troubleshooting/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesgatewaysthingsee-gateway-globaltroubleshooting><span>Troubleshooting</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicesgatewaysthingsee-gateway-lan-li><input type=checkbox id=m-devicesgatewaysthingsee-gateway-lan-check>
<label for=m-devicesgatewaysthingsee-gateway-lan-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/thingsee-gateway-lan/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicesgatewaysthingsee-gateway-lan><span>Thingsee GATEWAY LAN</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesgatewaysthingsee-gateway-laninstallation-li><input type=checkbox id=m-devicesgatewaysthingsee-gateway-laninstallation-check>
<label for=m-devicesgatewaysthingsee-gateway-laninstallation-check><a href=https://haltian.github.io/dev-doc-site/devices/gateways/thingsee-gateway-lan/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesgatewaysthingsee-gateway-laninstallation><span>Installation</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicestags-li><input type=checkbox id=m-devicestags-check>
<label for=m-devicestags-check><a href=https://haltian.github.io/dev-doc-site/devices/tags/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicestags><span>Tags</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicestagshaltian-nano-tag-li><input type=checkbox id=m-devicestagshaltian-nano-tag-check>
<label for=m-devicestagshaltian-nano-tag-check><a href=https://haltian.github.io/dev-doc-site/devices/tags/haltian-nano-tag/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicestagshaltian-nano-tag><span>Haltian NANO Tag</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicesaccessories-li><input type=checkbox id=m-devicesaccessories-check>
<label for=m-devicesaccessories-check><a href=https://haltian.github.io/dev-doc-site/devices/accessories/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicesaccessories><span>Accessories</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicesaccessoriesthingsee-powercover-li><input type=checkbox id=m-devicesaccessoriesthingsee-powercover-check>
<label for=m-devicesaccessoriesthingsee-powercover-check><a href=https://haltian.github.io/dev-doc-site/devices/accessories/thingsee-powercover/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicesaccessoriesthingsee-powercover><span>Thingsee POWERCOVER</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesaccessoriesthingsee-powercoverinstallation-li><input type=checkbox id=m-devicesaccessoriesthingsee-powercoverinstallation-check>
<label for=m-devicesaccessoriesthingsee-powercoverinstallation-check><a href=https://haltian.github.io/dev-doc-site/devices/accessories/thingsee-powercover/installation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesaccessoriesthingsee-powercoverinstallation><span>Installation</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicestechnical-reference-li><input type=checkbox id=m-devicestechnical-reference-check>
<label for=m-devicestechnical-reference-check><a href=https://haltian.github.io/dev-doc-site/devices/technical-reference/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicestechnical-reference><span>Technical Reference</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicestechnical-referencecbor-json-conversion-li><input type=checkbox id=m-devicestechnical-referencecbor-json-conversion-check>
<label for=m-devicestechnical-referencecbor-json-conversion-check><a href=https://haltian.github.io/dev-doc-site/devices/technical-reference/cbor-json-conversion/ title="Thingsee CBOR to JSON Conversion" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicestechnical-referencecbor-json-conversion><span>Thingsee CBOR to JSON</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicestechnical-referencegateway-binary-passthrough-li><input type=checkbox id=m-devicestechnical-referencegateway-binary-passthrough-check>
<label for=m-devicestechnical-referencegateway-binary-passthrough-check><a href=https://haltian.github.io/dev-doc-site/devices/technical-reference/gateway-binary-passthrough/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicestechnical-referencegateway-binary-passthrough><span>Gateway Binary Passthrough</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-deviceswirepas-ecosystem-li><input type=checkbox id=m-deviceswirepas-ecosystem-check>
<label for=m-deviceswirepas-ecosystem-check><a href=https://haltian.github.io/dev-doc-site/devices/wirepas-ecosystem/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-deviceswirepas-ecosystem><span>Wirepas Ecosystem</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-deviceswirepas-ecosystemthird-party-li><input type=checkbox id=m-deviceswirepas-ecosystemthird-party-check>
<label for=m-deviceswirepas-ecosystemthird-party-check><a href=https://haltian.github.io/dev-doc-site/devices/wirepas-ecosystem/third-party/ title="Third-Party Devices" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-deviceswirepas-ecosystemthird-party><span>Third-Party</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-deviceswirepas-ecosystemthird-partyconfidex-viking-li><input type=checkbox id=m-deviceswirepas-ecosystemthird-partyconfidex-viking-check>
<label for=m-deviceswirepas-ecosystemthird-partyconfidex-viking-check><a href=https://haltian.github.io/dev-doc-site/devices/wirepas-ecosystem/third-party/confidex-viking/ title="Confidex Viking Tags" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-deviceswirepas-ecosystemthird-partyconfidex-viking><span>Confidex Viking</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicesarchive-li><input type=checkbox id=m-devicesarchive-check>
<label for=m-devicesarchive-check><a href=https://haltian.github.io/dev-doc-site/devices/archive/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicesarchive><span>Archive (EOL)</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicesarchivethingsee-one-li><input type=checkbox id=m-devicesarchivethingsee-one-check>
<label for=m-devicesarchivethingsee-one-check><a href=https://haltian.github.io/dev-doc-site/devices/archive/thingsee-one/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicesarchivethingsee-one><span>Thingsee One</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesarchivethingsee-onesoftware-configuration-li><input type=checkbox id=m-devicesarchivethingsee-onesoftware-configuration-check>
<label for=m-devicesarchivethingsee-onesoftware-configuration-check><a href=https://haltian.github.io/dev-doc-site/devices/archive/thingsee-one/software-configuration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicesarchivethingsee-onesoftware-configuration><span>Software Configuration</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-devicesarchivethingsee-angle-li><input type=checkbox id=m-devicesarchivethingsee-angle-check>
<label for=m-devicesarchivethingsee-angle-check><a href=https://haltian.github.io/dev-doc-site/devices/archive/thingsee-angle/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-devicesarchivethingsee-angle><span>Thingsee ANGLE</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesarchivethingsee-angleinstallation-li><input type=checkbox id=m-devicesarchivethingsee-angleinstallation-check>
<label for=m-devicesarchivethingsee-angleinstallation-check><a href=https://haltian.github.io/dev-doc-site/devices/archive/thingsee-angle/installation/ title="How to Install Thingsee ANGLE" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesarchivethingsee-angleinstallation><span>ANGLE Installation</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-devicesreadme-li><input type=checkbox id=m-devicesreadme-check>
<label for=m-devicesreadme-check><a href=https://haltian.github.io/dev-doc-site/devices/readme/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-devicesreadme><span></span></a></label></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"></div><div class=td-toc data-proofer-ignore><div class=td-toc-title><span class=td-toc-title__text>On this page</span>
<a class=td-toc-title__link title="Top of page" href=#></a></div><nav id=TableOfContents><ul><li><a href=#overview>Overview</a><ul><li><a href=#why-cbor>Why CBOR?</a></li></ul></li><li><a href=#message-structure>Message Structure</a><ul><li><a href=#cbor-format-sensor--gateway>CBOR Format (Sensor → Gateway)</a></li><li><a href=#json-format-application-layer>JSON Format (Application Layer)</a></li></ul></li><li><a href=#cbor-mapping-tables>CBOR Mapping Tables</a><ul><li><a href=#header-fields>Header Fields</a></li><li><a href=#data-fields-common>Data Fields (Common)</a></li><li><a href=#sensor-measurements>Sensor Measurements</a></li><li><a href=#motion-and-position>Motion and Position</a></li><li><a href=#network-and-device-info>Network and Device Info</a></li><li><a href=#activity-and-energy>Activity and Energy</a></li><li><a href=#air-quality>Air Quality</a></li><li><a href=#measurement-data>Measurement Data</a></li><li><a href=#configuration-parameters>Configuration Parameters</a></li><li><a href=#profile-and-statistics>Profile and Statistics</a></li><li><a href=#occupancy-histogram>Occupancy Histogram</a></li><li><a href=#people-counting>People Counting</a></li></ul></li><li><a href=#event-ids-tsmev>Event IDs (tsmEv)</a></li><li><a href=#conversion-examples>Conversion Examples</a><ul><li><a href=#example-1-thingsee-presence-occupancy>Example 1: Thingsee PRESENCE Occupancy</a></li><li><a href=#example-2-thingsee-radar-occupancy>Example 2: Thingsee RADAR Occupancy</a></li><li><a href=#example-3-configuration-message-downlink>Example 3: Configuration Message (Downlink)</a></li></ul></li><li><a href=#wirepas-endpoint-configuration>Wirepas Endpoint Configuration</a><ul><li><a href=#endpoint-2121-thingsee-cbor>Endpoint 21/21 (Thingsee CBOR)</a></li><li><a href=#endpoint-247255-wirepas-cbor>Endpoint 247/255 (Wirepas CBOR)</a></li><li><a href=#endpoint-238238-tlv-format>Endpoint 238/238 (TLV Format)</a></li><li><a href=#configuration-requirements>Configuration Requirements</a></li></ul></li><li><a href=#decoder-implementations>Decoder Implementations</a><ul><li><a href=#python-decoder>Python Decoder</a></li><li><a href=#javascript-decoder>JavaScript Decoder</a></li><li><a href=#handling-compressed-messages>Handling Compressed Messages</a></li></ul></li><li><a href=#best-practices>Best Practices</a><ul><li><a href=#decoder-implementation>Decoder Implementation</a></li><li><a href=#timestamp-handling>Timestamp Handling</a></li><li><a href=#device-identification>Device Identification</a></li><li><a href=#error-handling>Error Handling</a></li><li><a href=#performance-optimization>Performance Optimization</a></li></ul></li><li><a href=#message-id-ranges>Message ID Ranges</a></li><li><a href=#troubleshooting>Troubleshooting</a><ul><li><a href=#no-messages-received>No Messages Received</a></li><li><a href=#cbor-decoding-errors>CBOR Decoding Errors</a></li><li><a href=#incorrect-values-after-conversion>Incorrect Values After Conversion</a></li><li><a href=#missing-timestamp>Missing Timestamp</a></li><li><a href=#unknown-cbor-indexes>Unknown CBOR Indexes</a></li></ul></li><li><a href=#related-documentation>Related Documentation</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=https://haltian.github.io/dev-doc-site/devices/>Devices</a></li><li class=breadcrumb-item><a href=https://haltian.github.io/dev-doc-site/devices/technical-reference/>Technical Reference</a></li><li class="breadcrumb-item active" aria-current=page>Thingsee CBOR to JSON</li></ol></nav><div class=td-content><h1>Thingsee CBOR to JSON Conversion</h1><div class=lead>Complete guide for converting Thingsee CBOR binary messages to JSON format</div><header class=article-meta></header><h2 id=overview>Overview</h2><p>Thingsee sensors transmit data using <strong>CBOR (Concise Binary Object Representation)</strong>, a compact binary format optimized for low-power wireless communication. Applications and cloud platforms consume this data as <strong>JSON</strong>, requiring conversion at the gateway or backend level.</p><p>This guide provides:</p><ul><li>Complete CBOR-to-JSON mapping tables</li><li>Conversion examples with real sensor messages</li><li>Decoder implementations in Python and JavaScript</li><li>Wirepas endpoint configuration details</li></ul><h3 id=why-cbor>Why CBOR?</h3><p>CBOR reduces message size by ~60-70% compared to JSON, which:</p><ul><li>Extends battery life (fewer radio transmissions)</li><li>Reduces network bandwidth consumption</li><li>Enables more frequent sensor updates</li><li>Supports larger mesh networks</li></ul><h2 id=message-structure>Message Structure</h2><h3 id=cbor-format-sensor--gateway>CBOR Format (Sensor → Gateway)</h3><p>CBOR messages contain only essential sensor data:</p><pre tabindex=0><code>Header fields:
- tsmId (CBOR index 1): Message ID
- tsmEv (CBOR index 2): Event ID

Data fields:
- Device-specific measurements (CBOR indexes 20-1211)
</code></pre><p>Gateway or backend must add:</p><ul><li><code>tsmTs</code> - Timestamp (from Wirepas time-in-transit)</li><li><code>tsmTuid</code> - Device serial (from Wirepas node ID)</li><li><code>tsmGw</code> - Gateway identifier (optional)</li></ul><h3 id=json-format-application-layer>JSON Format (Application Layer)</h3><p>Complete JSON structure with all fields populated:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>[{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;tsmId&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>13100</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;tsmEv&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;tsmTs&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1492603998</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;tsmTuid&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;TSPR04123456&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;tsmGw&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;TSGW2G987654&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;tsmAp&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;occupancy-monitoring&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&#34;moveCount&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>7</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}]</span>
</span></span></code></pre></div><h2 id=cbor-mapping-tables>CBOR Mapping Tables</h2><h3 id=header-fields>Header Fields</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Origin</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>tsmId</td><td>1</td><td>Sensor</td><td>13100</td><td>Message ID identifying data structure</td></tr><tr><td>tsmEv</td><td>2</td><td>Sensor</td><td>10</td><td>Event ID indicating trigger reason</td></tr><tr><td>tsmTs</td><td>3</td><td>Gateway</td><td>1492844596</td><td>UTC timestamp in seconds</td></tr><tr><td>tsmTuid</td><td>4</td><td>Gateway</td><td>&ldquo;TSPR04123&rdquo;</td><td>Device serial number</td></tr><tr><td>tsmGw</td><td>5</td><td>Gateway</td><td>&ldquo;TSGW2G321&rdquo;</td><td>Gateway identifier</td></tr><tr><td>tsmAp</td><td>6</td><td>Cloud</td><td>&ldquo;demo-app&rdquo;</td><td>Application context</td></tr><tr><td>tsmDstTuid</td><td>7</td><td>Cloud</td><td>&ldquo;TSGW2G321&rdquo;</td><td>Destination device (for commands)</td></tr><tr><td>tsmGwTs</td><td>8</td><td>Cloud</td><td>1492844601</td><td>Gateway receipt timestamp</td></tr><tr><td>tsmCloudTs</td><td>9</td><td>Cloud</td><td>1492844602</td><td>Cloud receipt timestamp</td></tr></tbody></table><h3 id=data-fields-common>Data Fields (Common)</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Multiplier (10^x)</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>pwr</td><td>20</td><td>0</td><td>0</td><td>Power status (0=OFF, 1=ON)</td></tr><tr><td>batl</td><td>21</td><td>1</td><td>882</td><td>Battery level (88.2% in example)</td></tr><tr><td>chrg</td><td>22</td><td>0</td><td>2</td><td>Charger status (0=Not connected, 1=Charging, 2=Connected not charging)</td></tr><tr><td>requestTsmId</td><td>23</td><td>0</td><td>1310</td><td>Requested message ID from cloud</td></tr><tr><td>timestamp</td><td>24</td><td>0</td><td>1493312188</td><td>Epoch timestamp</td></tr><tr><td>transactionId</td><td>25</td><td>0</td><td>1493312188</td><td>Transaction ID for request-response sync</td></tr><tr><td>uptime</td><td>26</td><td>0</td><td>3600</td><td>Seconds since device startup</td></tr><tr><td>status</td><td>27</td><td>0</td><td>0</td><td>Status code (message-specific)</td></tr></tbody></table><h3 id=sensor-measurements>Sensor Measurements</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Multiplier (10^x)</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>temp</td><td>30</td><td>1</td><td>224</td><td>Temperature in Celsius (22.4°C in example)</td></tr><tr><td>lght</td><td>31</td><td>0</td><td>720</td><td>Light in lux</td></tr><tr><td>humd</td><td>32</td><td>1</td><td>724</td><td>Humidity 0-100% (72.4% in example)</td></tr><tr><td>airp</td><td>33</td><td>3</td><td>102092358</td><td>Air pressure in Pascals (102092.358 Pa in example)</td></tr><tr><td>level</td><td>34</td><td>0</td><td>0</td><td>Level (message-specific unit)</td></tr><tr><td>min</td><td>35</td><td>0</td><td>0</td><td>Minimum value (message-specific)</td></tr><tr><td>max</td><td>36</td><td>0</td><td>0</td><td>Maximum value (message-specific)</td></tr><tr><td>mode</td><td>37</td><td>0</td><td>0</td><td>Operating mode (message-specific)</td></tr><tr><td>state</td><td>38</td><td>0</td><td>0</td><td>Device state (message-specific)</td></tr><tr><td>pressure</td><td>39</td><td>3</td><td>102092358</td><td>Pressure in Pascals</td></tr></tbody></table><h3 id=motion-and-position>Motion and Position</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Multiplier (10^x)</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>accx</td><td>40</td><td>0</td><td>0</td><td>X-axis acceleration</td></tr><tr><td>accy</td><td>41</td><td>0</td><td>-100</td><td>Y-axis acceleration</td></tr><tr><td>accz</td><td>42</td><td>0</td><td>900</td><td>Z-axis acceleration</td></tr><tr><td>move</td><td>43</td><td>0</td><td>1</td><td>Movement detected (0=No, 1=Yes)</td></tr><tr><td>moveCount</td><td>44</td><td>0</td><td>7</td><td>Movement count since last report</td></tr><tr><td>dist</td><td>45</td><td>0</td><td>152</td><td>Distance in millimeters</td></tr><tr><td>hall</td><td>46</td><td>0</td><td>1</td><td>Hall sensor state (0=Open, 1=Closed)</td></tr><tr><td>hallCount</td><td>47</td><td>0</td><td>1</td><td>Hall sensor state change count</td></tr><tr><td>switch</td><td>48</td><td>0</td><td>1</td><td>Switch state (0=Open, 1=Closed)</td></tr><tr><td>switchCount</td><td>49</td><td>0</td><td>1</td><td>Switch state change count</td></tr><tr><td>gforce</td><td>56</td><td>0</td><td>1012</td><td>G-force sum vector in milli-g</td></tr><tr><td>gforceMax</td><td>57</td><td>0</td><td>3567</td><td>Maximum g-force in milli-g</td></tr><tr><td>angle</td><td>190</td><td>1</td><td>900</td><td>Angular position in degrees (90.0° in example)</td></tr><tr><td>duration</td><td>191</td><td>0</td><td>1800</td><td>Duration in seconds</td></tr></tbody></table><h3 id=network-and-device-info>Network and Device Info</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Multiplier (10^x)</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>voltage</td><td>59</td><td>6</td><td>3000000</td><td>Voltage in volts (3.0V in example)</td></tr><tr><td>wpnode</td><td>60</td><td>N/A</td><td>&lsquo;123456&rsquo;</td><td>Wirepas node ID (string)</td></tr><tr><td>rssi</td><td>61</td><td>0</td><td>78</td><td>RSSI value (0-255 scale)</td></tr><tr><td>tuid</td><td>62</td><td>N/A</td><td>&lsquo;S3R14LNUMB3R&rsquo;</td><td>Cloud identifier (string)</td></tr><tr><td>rssiDbm</td><td>65</td><td>0</td><td>-70</td><td>RSSI in dBm</td></tr><tr><td>swVersion</td><td>70</td><td>N/A</td><td>&lsquo;sensorFW1.0.2&rsquo;</td><td>Software version (string)</td></tr><tr><td>modelCode</td><td>71</td><td>N/A</td><td>&lsquo;TSGW2G&rsquo;</td><td>Product model code (string)</td></tr></tbody></table><h3 id=activity-and-energy>Activity and Energy</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Multiplier (10^x)</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>activityLevel</td><td>81</td><td>3</td><td>98000</td><td>Activity level indicator 0-100 (98.000 in example)</td></tr><tr><td>energyLevel</td><td>89</td><td>0</td><td>2647</td><td>Cumulative energy volume as force vector sum</td></tr><tr><td>energyLevelThreshold</td><td>291</td><td>0</td><td>1</td><td>Energy level threshold</td></tr><tr><td>activityLevelThreshold</td><td>292</td><td>3</td><td>1</td><td>Activity level threshold</td></tr></tbody></table><h3 id=air-quality>Air Quality</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Multiplier (10^x)</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>carbonDioxide</td><td>283</td><td>0</td><td>624</td><td>CO2 in ppm</td></tr><tr><td>tvoc</td><td>284</td><td>0</td><td>50</td><td>Total VOC</td></tr><tr><td>carbonDioxideHysteresis</td><td>281</td><td>0</td><td>10</td><td>CO2 hysteresis threshold</td></tr><tr><td>tvocHysteresis</td><td>282</td><td>0</td><td>5</td><td>TVOC hysteresis threshold</td></tr></tbody></table><h3 id=measurement-data>Measurement Data</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Multiplier (10^x)</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>resistance</td><td>111</td><td>0</td><td>1000</td><td>Resistance in ohms</td></tr><tr><td>index</td><td>112</td><td>0</td><td>1</td><td>Index value</td></tr><tr><td>count</td><td>113</td><td>0</td><td>1</td><td>Count value</td></tr><tr><td>messageIndex</td><td>146</td><td>0</td><td>1</td><td>Message sequence index</td></tr><tr><td>deviceState</td><td>147</td><td>0</td><td>1</td><td>Device state indicator</td></tr><tr><td>restartCount</td><td>154</td><td>0</td><td>1</td><td>Device restart count</td></tr><tr><td>lastUpdate</td><td>170</td><td>0</td><td>0</td><td>Time since last update</td></tr><tr><td>static</td><td>171</td><td>0</td><td>0</td><td>Static indicator</td></tr><tr><td>length</td><td>181</td><td>0</td><td>0</td><td>Length value</td></tr><tr><td>data</td><td>182</td><td>N/A</td><td>-</td><td>Generic data field</td></tr><tr><td>command</td><td>183</td><td>N/A</td><td>-</td><td>Command field</td></tr><tr><td>payload</td><td>184</td><td>N/A</td><td>-</td><td>Command payload</td></tr></tbody></table><h3 id=configuration-parameters>Configuration Parameters</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Multiplier (10^x)</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>measurementInterval</td><td>256</td><td>0</td><td>60</td><td>Measurement interval in seconds</td></tr><tr><td>measurementFrequency</td><td>257</td><td>0</td><td>25</td><td>Measurement frequency in Hz</td></tr><tr><td>reportInterval</td><td>258</td><td>0</td><td>300</td><td>Reporting interval in seconds</td></tr><tr><td>impactThresholdMin</td><td>259</td><td>0</td><td>200</td><td>Lower impact threshold in mG</td></tr><tr><td>impactThresholdMax</td><td>260</td><td>1</td><td>1000</td><td>Upper impact threshold in mG</td></tr><tr><td>idleInterval</td><td>261</td><td>0</td><td>3600</td><td>Idle interval in seconds</td></tr><tr><td>accelerometerMode</td><td>262</td><td>0</td><td>0</td><td>Accelerometer configuration mode</td></tr><tr><td>threshold</td><td>263</td><td>0</td><td>0</td><td>Generic threshold value</td></tr><tr><td>enableLed</td><td>264</td><td>0</td><td>0</td><td>LED control setting</td></tr><tr><td>weatherMode</td><td>266</td><td>0</td><td>0</td><td>Weather sensor configuration</td></tr><tr><td>hallMode</td><td>267</td><td>0</td><td>0</td><td>Hall sensor configuration</td></tr><tr><td>leakageMode</td><td>268</td><td>0</td><td>0</td><td>Leakage sensor configuration</td></tr><tr><td>autoCalibration</td><td>269</td><td>N/A</td><td>-</td><td>Auto-calibration setting</td></tr><tr><td>calibrationValue</td><td>270</td><td>N/A</td><td>-</td><td>Calibration value</td></tr><tr><td>filterValue</td><td>271</td><td>N/A</td><td>-</td><td>Filter value</td></tr><tr><td>commandId</td><td>272</td><td>0</td><td>1493312188</td><td>Command transaction ID</td></tr><tr><td>temperatureMode</td><td>273</td><td>0</td><td>0</td><td>Temperature sensor mode</td></tr><tr><td>intervalMultiplier</td><td>274</td><td>0</td><td>0</td><td>Interval multiplier</td></tr><tr><td>temperatureHysteresis</td><td>275</td><td>1</td><td>5</td><td>Temperature hysteresis (0.5°C in example)</td></tr><tr><td>humidityHysteresis</td><td>276</td><td>1</td><td>20</td><td>Humidity hysteresis (2.0% in example)</td></tr><tr><td>pressureHysteresis</td><td>277</td><td>3</td><td>20000</td><td>Pressure hysteresis (20 Pa in example)</td></tr><tr><td>lightHysteresis</td><td>278</td><td>0</td><td>100</td><td>Light hysteresis in lux</td></tr><tr><td>resistanceHysteresis</td><td>279</td><td>0</td><td>10000</td><td>Resistance hysteresis in ohms</td></tr><tr><td>orientationHysteresis</td><td>280</td><td>0</td><td>5</td><td>Orientation hysteresis in degrees</td></tr><tr><td>staticFilter</td><td>285</td><td>0</td><td>2</td><td>Static filter setting</td></tr><tr><td>dynamicFilter</td><td>286</td><td>0</td><td>1</td><td>Dynamic filter setting</td></tr><tr><td>samples</td><td>287</td><td>0</td><td>8</td><td>Sample count</td></tr><tr><td>averaging</td><td>288</td><td>0</td><td>1</td><td>Averaging setting</td></tr><tr><td>rounding</td><td>289</td><td>0</td><td>1</td><td>Rounding setting</td></tr><tr><td>pressureCompensate</td><td>290</td><td>0</td><td>1</td><td>Pressure compensation setting</td></tr><tr><td>autoRole</td><td>543</td><td>0</td><td>0</td><td>Wirepas auto-role setting</td></tr><tr><td>lowLatency</td><td>544</td><td>0</td><td>0</td><td>Wirepas low-latency setting</td></tr></tbody></table><h3 id=profile-and-statistics>Profile and Statistics</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Multiplier (10^x)</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>profileId</td><td>1100</td><td>0</td><td>0</td><td>Configuration profile ID</td></tr><tr><td>tempMin</td><td>1101</td><td>1</td><td>-23</td><td>Minimum temperature (-2.3°C in example)</td></tr><tr><td>tempMax</td><td>1102</td><td>1</td><td>156</td><td>Maximum temperature (15.6°C in example)</td></tr><tr><td>humdMin</td><td>1103</td><td>1</td><td>556</td><td>Minimum humidity (55.6% in example)</td></tr><tr><td>humdMax</td><td>1104</td><td>1</td><td>612</td><td>Maximum humidity (61.2% in example)</td></tr><tr><td>fromTimestamp</td><td>1105</td><td>0</td><td>1493312188</td><td>Period start timestamp</td></tr></tbody></table><h3 id=occupancy-histogram>Occupancy Histogram</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Multiplier (10^x)</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>histogram0</td><td>1000</td><td>0</td><td>2</td><td>Detection count in area index 0</td></tr><tr><td>histogram1</td><td>1001</td><td>0</td><td>7</td><td>Detection count in area index 1</td></tr><tr><td>histogram2</td><td>1002</td><td>0</td><td>13</td><td>Detection count in area index 2</td></tr><tr><td>histogram3</td><td>1003</td><td>0</td><td>45</td><td>Detection count in area index 3</td></tr><tr><td>histogram4</td><td>1004</td><td>0</td><td>234</td><td>Detection count in area index 4</td></tr><tr><td>histogram5</td><td>1005</td><td>0</td><td>153</td><td>Detection count in area index 5</td></tr><tr><td>histogram6</td><td>1006</td><td>0</td><td>78</td><td>Detection count in area index 6</td></tr><tr><td>histogram7</td><td>1007</td><td>0</td><td>45</td><td>Detection count in area index 7</td></tr><tr><td>histogram8</td><td>1008</td><td>0</td><td>32</td><td>Detection count in area index 8</td></tr><tr><td>histogram9</td><td>1009</td><td>0</td><td>2</td><td>Detection count in area index 9</td></tr></tbody></table><h3 id=people-counting>People Counting</h3><table><thead><tr><th>JSON Property</th><th>CBOR Index</th><th>Multiplier (10^x)</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td>in</td><td>1210</td><td>0</td><td>10</td><td>Ingress count (people entering)</td></tr><tr><td>out</td><td>1211</td><td>0</td><td>8</td><td>Egress count (people leaving)</td></tr></tbody></table><h2 id=event-ids-tsmev>Event IDs (tsmEv)</h2><p>Event IDs indicate why the message was sent:</p><table><thead><tr><th>Event ID</th><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>0</td><td>No event</td><td>Event data not applicable or unknown</td></tr><tr><td>7</td><td>State change event</td><td>Result of a state change</td></tr><tr><td>8</td><td>Key event</td><td>Reactive events (sensor-triggered, key press)</td></tr><tr><td>9</td><td>Threshold event</td><td>Threshold exceeded</td></tr><tr><td>10</td><td>Timed event</td><td>Streaming event sent at defined intervals</td></tr><tr><td>11</td><td>Thing powered ON</td><td>Device boot-up</td></tr><tr><td>12</td><td>Thing powered OFF</td><td>Device powering off</td></tr><tr><td>13</td><td>Thing controlled reset occurred</td><td>Controlled reset performed</td></tr><tr><td>14</td><td>Thing uncontrolled reset occurred</td><td>Uncontrolled reset occurred</td></tr><tr><td>15</td><td>Thing firmware updated</td><td>Firmware update completed</td></tr><tr><td>16</td><td>Thing software configuration updated</td><td>Software configuration changed</td></tr><tr><td>17</td><td>Network connected</td><td>Connected to gateway/network</td></tr><tr><td>18</td><td>Network disconnected</td><td>Disconnected from gateway/network</td></tr><tr><td>19</td><td>Assistance data requested</td><td>Request for assistance data from cloud</td></tr><tr><td>20</td><td>Assistance data response</td><td>Response to assistance data request</td></tr><tr><td>21</td><td>Power ON requested</td><td>Cloud request to power ON</td></tr><tr><td>22</td><td>Power OFF requested</td><td>Cloud request to power OFF</td></tr><tr><td>23</td><td>Reset requested</td><td>Cloud request to reset</td></tr><tr><td>25</td><td>Firmware update requested</td><td>Cloud request for firmware update</td></tr><tr><td>26</td><td>Software configuration update requested</td><td>Cloud request for configuration update</td></tr><tr><td>27</td><td>Diagnostics requested</td><td>Cloud request to enable diagnostics</td></tr><tr><td>28</td><td>Requested diagnostic event</td><td>Remotely enabled diagnostic event</td></tr><tr><td>29</td><td>Error diagnostic event</td><td>Critical error report</td></tr><tr><td>30</td><td>Application profile update requested</td><td>Device must update behavior</td></tr><tr><td>31</td><td>Application profile update response</td><td>Response to profile update request</td></tr><tr><td>32</td><td>Firmware information request</td><td>Request for firmware information</td></tr><tr><td>33</td><td>Firmware information response</td><td>Response to firmware information request</td></tr><tr><td>34</td><td>Timed diagnostics event</td><td>Periodic diagnostic event</td></tr><tr><td>35</td><td>Command request</td><td>Command sent to device</td></tr><tr><td>36</td><td>Command response</td><td>Response to command</td></tr></tbody></table><h2 id=conversion-examples>Conversion Examples</h2><h3 id=example-1-thingsee-presence-occupancy>Example 1: Thingsee PRESENCE Occupancy</h3><p><strong>Raw hex message:</strong></p><pre tabindex=0><code>9f a3 01 19 33 2c 02 0a 18 2c 07 ff
</code></pre><p><strong>Step 1: CBOR decode</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>[{</span><span style=color:#a40000>1:</span> <span style=color:#a40000>13100,</span> <span style=color:#a40000>2:</span> <span style=color:#a40000>10,</span> <span style=color:#a40000>44:</span> <span style=color:#a40000>7</span><span style=color:#000;font-weight:700>}]</span>
</span></span></code></pre></div><p><strong>Step 2: Apply CBOR index mapping</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>[{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmId&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>13100</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmEv&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;moveCount&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>7</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}]</span>
</span></span></code></pre></div><p><strong>Step 3: Add gateway-originated fields</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>[{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmId&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>13100</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmEv&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmTs&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1492844596</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmTuid&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;TSPR04123456&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmGw&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;TSGW2G987654&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;moveCount&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>7</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}]</span>
</span></span></code></pre></div><p><strong>Interpretation:</strong></p><ul><li>Device: Thingsee PRESENCE (message ID 13100)</li><li>Event: Timed event (event ID 10)</li><li>Data: 7 movements detected since last report</li></ul><h3 id=example-2-thingsee-radar-occupancy>Example 2: Thingsee RADAR Occupancy</h3><p><strong>Raw hex message:</strong></p><pre tabindex=0><code>9f a5 01 19 6d 69 02 07 19 04 ff 19 06 21 18 26 01 18 2d 19 06 40 ff
</code></pre><p><strong>Step 1: CBOR decode</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>[{</span><span style=color:#a40000>1:</span> <span style=color:#a40000>28009,</span> <span style=color:#a40000>2:</span> <span style=color:#a40000>7,</span> <span style=color:#a40000>1279:</span> <span style=color:#a40000>1569,</span> <span style=color:#a40000>38:</span> <span style=color:#a40000>1,</span> <span style=color:#a40000>45:</span> <span style=color:#a40000>1600</span><span style=color:#000;font-weight:700>}]</span>
</span></span></code></pre></div><p><strong>Step 2: Apply CBOR index mapping</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>[{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmId&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>28009</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmEv&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;echo&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1569</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;state&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;dist&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1600</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}]</span>
</span></span></code></pre></div><p>Note: Index 1279 (&ldquo;echo&rdquo;) is device-specific and not in the common mapping table. Refer to device-specific documentation for custom indexes.</p><p><strong>Step 3: Add gateway fields and apply multipliers</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>[{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmId&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>28009</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmEv&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmTs&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1492844596</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmTuid&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;TSRAD5123456&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;dist&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1600</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;echo&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1569</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;state&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}]</span>
</span></span></code></pre></div><p><strong>Interpretation:</strong></p><ul><li>Device: Thingsee RADAR (message ID 28009)</li><li>Event: State change event (event ID 7)</li><li>Data: Object detected at 1600mm distance, occupied state</li></ul><h3 id=example-3-configuration-message-downlink>Example 3: Configuration Message (Downlink)</h3><p><strong>JSON configuration request:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmId&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1500</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;tsmEv&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;transactionId&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1485925806</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;measurementInterval&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;reportInterval&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>300</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>Step 1: Convert to CBOR indexes</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#a40000>1:</span> <span style=color:#a40000>1500,</span> <span style=color:#a40000>2:</span> <span style=color:#a40000>30,</span> <span style=color:#a40000>25:</span> <span style=color:#a40000>1485925806,</span> <span style=color:#a40000>256:</span> <span style=color:#a40000>30,</span> <span style=color:#a40000>258:</span> <span style=color:#a40000>300</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>Step 2: CBOR encode to binary</strong></p><pre tabindex=0><code>a5 01 19 05 dc 02 18 1e 18 19 1a 58 91 6d ae 19 01 00 18 1e 19 01 02 19 01 2c
</code></pre><p><strong>Important:</strong> Wirepas endpoints must be 21/21 for sensor configuration messages.</p><h2 id=wirepas-endpoint-configuration>Wirepas Endpoint Configuration</h2><p>Thingsee sensors use different Wirepas endpoints depending on the CBOR format:</p><h3 id=endpoint-2121-thingsee-cbor>Endpoint 21/21 (Thingsee CBOR)</h3><p><strong>Use case:</strong> Standard Thingsee sensor messages</p><p><strong>Format:</strong> CBOR with Thingsee message specification</p><p><strong>MQTT topic structure:</strong></p><pre tabindex=0><code>haltian-iot/wirepas/gw-event/received_data/{gateway-id}/sink1/{network-id}/21/21
</code></pre><p><strong>Characteristics:</strong></p><ul><li>Uses complete mapping table (indexes 1-1211)</li><li>Compatible with all Thingsee sensors</li><li>Standard for configuration (downlink) messages</li><li>Most common format in Haltian IoT deployments</li></ul><h3 id=endpoint-247255-wirepas-cbor>Endpoint 247/255 (Wirepas CBOR)</h3><p><strong>Use case:</strong> Wirepas reference implementation format</p><p><strong>Format:</strong> CBOR following Wirepas standard</p><p><strong>MQTT topic structure:</strong></p><pre tabindex=0><code>haltian-iot/wirepas/gw-event/received_data/{gateway-id}/sink1/{network-id}/247/255
</code></pre><p><strong>Characteristics:</strong></p><ul><li>May use different CBOR map version (5.1 vs 5.2)</li><li>Interoperable with Wirepas ecosystem devices</li><li>Different header structure compared to endpoint 21/21</li></ul><h3 id=endpoint-238238-tlv-format>Endpoint 238/238 (TLV Format)</h3><p><strong>Use case:</strong> Tag-Length-Value encoding (legacy)</p><p><strong>Format:</strong> TLV binary format</p><p><strong>MQTT topic structure:</strong></p><pre tabindex=0><code>haltian-iot/wirepas/gw-event/received_data/{gateway-id}/sink1/{network-id}/238/238
</code></pre><p><strong>Characteristics:</strong></p><ul><li>Not CBOR format</li><li>Used by specific legacy devices</li><li>Requires separate decoder implementation</li></ul><h3 id=configuration-requirements>Configuration Requirements</h3><p><strong>For sensor configuration (downlink):</strong></p><ul><li><strong>Endpoints must be 21/21</strong> - sensors reject messages from other endpoints</li><li>Include <code>transactionId</code> (CBOR index 25) for request-response correlation</li><li>Sensor replies with same <code>tsmId</code>, all configuration fields populated with current values</li></ul><p><strong>For monitoring network traffic:</strong></p><ul><li>Subscribe to all endpoints: <code>#</code> wildcard</li><li>Filter by source endpoint to identify message format</li><li>Use appropriate decoder for each endpoint type</li></ul><h2 id=decoder-implementations>Decoder Implementations</h2><h3 id=python-decoder>Python Decoder</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>cbor2</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>struct</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>from</span> <span style=color:#000>datetime</span> <span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>datetime</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># CBOR index to JSON property mapping</span>
</span></span><span style=display:flex><span><span style=color:#000>CBOR_INDEX_MAP</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Header</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;tsmId&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;tsmEv&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;tsmTs&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;tsmTuid&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;tsmGw&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;tsmAp&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;tsmDstTuid&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>8</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;tsmGwTs&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>9</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;tsmCloudTs&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Common data fields</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>20</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;pwr&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>21</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;batl&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>22</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;chrg&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>23</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;requestTsmId&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>24</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;timestamp&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>25</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;transactionId&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>26</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;uptime&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>27</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;status&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Sensor measurements</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;temp&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>31</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;lght&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>32</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;humd&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>33</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;airp&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>34</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;level&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>35</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;min&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>36</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;max&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>37</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;mode&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>38</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;state&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>39</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;pressure&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Motion</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>40</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;accx&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>41</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;accy&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>42</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;accz&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>43</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;move&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>44</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;moveCount&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>45</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;dist&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>46</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hall&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>47</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hallCount&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>48</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;switch&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>49</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;switchCount&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>56</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;gforce&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>57</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;gforceMax&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Network</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>59</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;voltage&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>60</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;wpnode&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>61</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;rssi&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>62</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;tuid&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>65</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;rssiDbm&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>70</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;swVersion&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>71</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;modelCode&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Activity</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>81</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;activityLevel&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>89</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;energyLevel&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Configuration</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>256</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;measurementInterval&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>257</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;measurementFrequency&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>258</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;reportInterval&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>259</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;impactThresholdMin&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>260</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;impactThresholdMax&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>261</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;idleInterval&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>262</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;accelerometerMode&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>263</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;threshold&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>264</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;enableLed&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Air quality</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>283</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;carbonDioxide&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>284</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;tvoc&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Histogram</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1000</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;histogram0&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1001</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;histogram1&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1002</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;histogram2&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1003</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;histogram3&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1004</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;histogram4&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1005</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;histogram5&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1006</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;histogram6&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1007</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;histogram7&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1008</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;histogram8&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1009</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;histogram9&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># People counting</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1210</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;in&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0000cf;font-weight:700>1211</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;out&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Multipliers for fields requiring decimal conversion</span>
</span></span><span style=display:flex><span><span style=color:#000>MULTIPLIERS</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;batl&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;temp&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;humd&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;airp&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;pressure&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;voltage&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;activityLevel&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;impactThresholdMax&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;angle&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;tempMin&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;tempMax&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;humdMin&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;humdMax&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;temperatureHysteresis&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;humidityHysteresis&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;pressureHysteresis&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;activityLevelThreshold&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>def</span> <span style=color:#000>decode_cbor_message</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binary_payload</span><span style=color:#000;font-weight:700>):</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    Decode CBOR binary payload to JSON structure.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    Args:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        binary_payload: bytes - Raw CBOR binary data
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    Returns:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        dict - Decoded message with JSON property names
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>try</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic># Decode CBOR to Python dict</span>
</span></span><span style=display:flex><span>        <span style=color:#000>cbor_data</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cbor2</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>loads</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binary_payload</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic># Handle array wrapper (messages typically come as single-element arrays)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#204a87>isinstance</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cbor_data</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>list</span><span style=color:#000;font-weight:700>):</span>
</span></span><span style=display:flex><span>            <span style=color:#000>cbor_data</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cbor_data</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]</span> <span style=color:#204a87;font-weight:700>if</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cbor_data</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic># Convert CBOR indexes to JSON property names</span>
</span></span><span style=display:flex><span>        <span style=color:#000>json_message</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>cbor_index</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>value</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>cbor_data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>items</span><span style=color:#000;font-weight:700>():</span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic># Get JSON property name</span>
</span></span><span style=display:flex><span>            <span style=color:#000>prop_name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>CBOR_INDEX_MAP</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cbor_index</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>f</span><span style=color:#4e9a06>&#34;unknown_</span><span style=color:#4e9a06>{</span><span style=color:#000>cbor_index</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic># Apply multiplier if needed</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>prop_name</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>MULTIPLIERS</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>                <span style=color:#000>multiplier</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>MULTIPLIERS</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>prop_name</span><span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span>                <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span> <span style=color:#ce5c00;font-weight:700>**</span> <span style=color:#000>multiplier</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#000>json_message</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>prop_name</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>value</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>json_message</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>except</span> <span style=color:#c00;font-weight:700>Exception</span> <span style=color:#204a87;font-weight:700>as</span> <span style=color:#000>e</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>f</span><span style=color:#4e9a06>&#34;Error decoding CBOR: </span><span style=color:#4e9a06>{</span><span style=color:#000>e</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>None</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>def</span> <span style=color:#000>add_gateway_fields</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>json_message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>wirepas_node_id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gateway_id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>network_timestamp</span><span style=color:#000;font-weight:700>):</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    Add gateway-originated fields to sensor message.
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    Args:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        json_message: dict - Decoded sensor message
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        wirepas_node_id: int - Wirepas node ID
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        gateway_id: str - Gateway identifier
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        network_timestamp: int - Wirepas network timestamp
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    Returns:
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        dict - Complete message with gateway fields
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Add timestamp (convert Wirepas time to UTC)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>json_message</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;tsmTs&#34;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>network_timestamp</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Add device identifier (lookup serial from node ID mapping)</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># In production, query device database with wirepas_node_id</span>
</span></span><span style=display:flex><span>    <span style=color:#000>json_message</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;tsmTuid&#34;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>f</span><span style=color:#4e9a06>&#34;NODE</span><span style=color:#4e9a06>{</span><span style=color:#000>wirepas_node_id</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Add gateway identifier</span>
</span></span><span style=display:flex><span>    <span style=color:#000>json_message</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;tsmGw&#34;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>gateway_id</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>json_message</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Example usage</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>__name__</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#34;__main__&#34;</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Example: Thingsee PRESENCE movement message</span>
</span></span><span style=display:flex><span>    <span style=color:#000>hex_message</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;9fa3011933 2c020a182c07ff&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>binary_payload</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>bytes</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>fromhex</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hex_message</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>replace</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34; &#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Decode</span>
</span></span><span style=display:flex><span>    <span style=color:#000>message</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>decode_cbor_message</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binary_payload</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Decoded message:&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Output: {&#39;tsmId&#39;: 13100, &#39;tsmEv&#39;: 10, &#39;moveCount&#39;: 7}</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic># Add gateway fields</span>
</span></span><span style=display:flex><span>    <span style=color:#000>complete_message</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>add_gateway_fields</span><span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>        <span style=color:#000>message</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>wirepas_node_id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>123456</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>gateway_id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;TSGW2G987654&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>network_timestamp</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#0000cf;font-weight:700>1492844596</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Complete message:&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>complete_message</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h3 id=javascript-decoder>JavaScript Decoder</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>cbor</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>require</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;cbor&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// CBOR index to JSON property mapping
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>CBOR_INDEX_MAP</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Header
</span></span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;tsmId&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;tsmEv&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;tsmTs&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>4</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;tsmTuid&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;tsmGw&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>6</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;tsmAp&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>7</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;tsmDstTuid&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>8</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;tsmGwTs&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>9</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;tsmCloudTs&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Common data fields
</span></span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>20</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;pwr&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>21</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;batl&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>22</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;chrg&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>23</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;requestTsmId&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>24</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;timestamp&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>25</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;transactionId&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>26</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;uptime&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>27</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;status&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Sensor measurements
</span></span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>30</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;temp&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>31</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;lght&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>32</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;humd&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>33</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;airp&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>38</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;state&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>44</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;moveCount&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>45</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;dist&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Add more mappings as needed...
</span></span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// People counting
</span></span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>1210</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;in&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>1211</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;out&#39;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Multipliers for decimal conversion
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>MULTIPLIERS</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>batl</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#000>temp</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#000>humd</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#000>airp</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#000>voltage</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#000>activityLevel</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#000>angle</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * Decode CBOR binary payload to JSON structure
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * @param {Buffer} binaryPayload - Raw CBOR binary data
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * @returns {Object} Decoded message with JSON property names
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> */</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>decodeCborMessage</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binaryPayload</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>try</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Decode CBOR to JavaScript object
</span></span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>let</span> <span style=color:#000>cborData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cbor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>decodeFirstSync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binaryPayload</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Handle array wrapper
</span></span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#204a87>Array</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>isArray</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cborData</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#000>cborData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cborData</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#ce5c00;font-weight:700>?</span> <span style=color:#000>cborData</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>{};</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Convert CBOR indexes to JSON property names
</span></span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>jsonMessage</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{};</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000;font-weight:700>[</span><span style=color:#000>cborIndex</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>value</span><span style=color:#000;font-weight:700>]</span> <span style=color:#204a87;font-weight:700>of</span> <span style=color:#204a87>Object</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>entries</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cborData</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>index</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87>parseInt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cborIndex</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#8f5902;font-style:italic>// Get JSON property name
</span></span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>propName</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>CBOR_INDEX_MAP</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>index</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#4e9a06>`unknown_</span><span style=color:#4e9a06>${</span><span style=color:#000>index</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>`</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#8f5902;font-style:italic>// Apply multiplier if needed
</span></span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>let</span> <span style=color:#000>finalValue</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>value</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>propName</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>MULTIPLIERS</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>multiplier</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>MULTIPLIERS</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>propName</span><span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span>        <span style=color:#000>finalValue</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>/</span> <span style=color:#204a87>Math</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>pow</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>multiplier</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#000>jsonMessage</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>propName</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>finalValue</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>jsonMessage</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;Error decoding CBOR:&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>error</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * Add gateway-originated fields to sensor message
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * @param {Object} jsonMessage - Decoded sensor message
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * @param {number} wirepasNodeId - Wirepas node ID
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * @param {string} gatewayId - Gateway identifier
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * @param {number} networkTimestamp - Wirepas network timestamp
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> * @returns {Object} Complete message with gateway fields
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic> */</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>addGatewayFields</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>jsonMessage</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>wirepasNodeId</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>gatewayId</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>networkTimestamp</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Add timestamp
</span></span></span><span style=display:flex><span>  <span style=color:#000>jsonMessage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>tsmTs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>networkTimestamp</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Add device identifier (lookup from database in production)
</span></span></span><span style=display:flex><span>  <span style=color:#000>jsonMessage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>tsmTuid</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>`NODE</span><span style=color:#4e9a06>${</span><span style=color:#000>wirepasNodeId</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>`</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>// Add gateway identifier
</span></span></span><span style=display:flex><span>  <span style=color:#000>jsonMessage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>tsmGw</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>gatewayId</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>jsonMessage</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Example usage
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>hexMessage</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;9fa3011933 2c020a182c07ff&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>binaryPayload</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Buffer</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>from</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hexMessage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>replace</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>/\s/g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;&#39;</span><span style=color:#000;font-weight:700>),</span> <span style=color:#4e9a06>&#39;hex&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Decode
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>message</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>decodeCborMessage</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binaryPayload</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;Decoded message:&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Output: { tsmId: 13100, tsmEv: 10, moveCount: 7 }
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Add gateway fields
</span></span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>completeMessage</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>addGatewayFields</span><span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>  <span style=color:#000>message</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>123456</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#4e9a06>&#39;TSGW2G987654&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0000cf;font-weight:700>1492844596</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;Complete message:&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>completeMessage</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><h3 id=handling-compressed-messages>Handling Compressed Messages</h3><p>Some devices send compressed CBOR using zlib. Add decompression before CBOR decoding:</p><p><strong>Python with zlib:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>zlib</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>cbor2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>def</span> <span style=color:#000>decode_compressed_cbor</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binary_payload</span><span style=color:#000;font-weight:700>):</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>try</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic># Decompress with zlib</span>
</span></span><span style=display:flex><span>        <span style=color:#000>decompressed</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>zlib</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>decompress</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binary_payload</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic># Decode CBOR</span>
</span></span><span style=display:flex><span>        <span style=color:#000>cbor_data</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cbor2</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>loads</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>decompressed</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic># Process as normal...</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>cbor_data</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>except</span> <span style=color:#000>zlib</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic># Not compressed, decode directly</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>cbor2</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>loads</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binary_payload</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p><strong>JavaScript with pako:</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>pako</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>require</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;pako&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>cbor</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>require</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;cbor&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>decodeCompressedCbor</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binaryPayload</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>try</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Try decompression
</span></span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>decompressed</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>pako</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>inflate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binaryPayload</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>cborData</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>cbor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>decodeFirstSync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Buffer</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>from</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>decompressed</span><span style=color:#000;font-weight:700>));</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>cborData</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>catch</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Not compressed, decode directly
</span></span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>cbor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>decodeFirstSync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>binaryPayload</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=best-practices>Best Practices</h2><h3 id=decoder-implementation>Decoder Implementation</h3><ol><li><p><strong>Use established CBOR libraries</strong> - Don&rsquo;t implement CBOR parser from scratch</p><ul><li>Python: <code>cbor2</code></li><li>JavaScript: <code>cbor</code></li><li>Java: <code>com.fasterxml.jackson.dataformat:jackson-dataformat-cbor</code></li><li>C#: <code>PeterO.Cbor</code></li></ul></li><li><p><strong>Handle unknown indexes gracefully</strong> - New firmware may introduce fields not in your mapping table</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>prop_name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>CBOR_INDEX_MAP</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cbor_index</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>f</span><span style=color:#4e9a06>&#34;unknown_</span><span style=color:#4e9a06>{</span><span style=color:#000>cbor_index</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div></li><li><p><strong>Validate message structure</strong> - Check for required fields before processing</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#4e9a06>&#34;tsmId&#34;</span> <span style=color:#204a87;font-weight:700>not</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>message</span> <span style=color:#204a87;font-weight:700>or</span> <span style=color:#4e9a06>&#34;tsmEv&#34;</span> <span style=color:#204a87;font-weight:700>not</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>message</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>warning</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Invalid message structure&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>None</span>
</span></span></code></pre></div></li><li><p><strong>Log unknown indexes</strong> - Track unmapped indexes to update decoder</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>cbor_index</span> <span style=color:#204a87;font-weight:700>not</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>CBOR_INDEX_MAP</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#000>logger</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>info</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>f</span><span style=color:#4e9a06>&#34;Unknown CBOR index </span><span style=color:#4e9a06>{</span><span style=color:#000>cbor_index</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06> with value </span><span style=color:#4e9a06>{</span><span style=color:#000>value</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div></li></ol><h3 id=timestamp-handling>Timestamp Handling</h3><ol><li><strong>Sensor messages don&rsquo;t include timestamps</strong> - Gateway must add from Wirepas time-in-transit</li><li><strong>Use UTC timestamps</strong> - All <code>tsmTs</code> values are UTC epoch seconds</li><li><strong>Precision</strong> - Can use decimals for millisecond resolution (e.g., <code>1492844596.123</code>)</li><li><strong>Network disconnected events (tsmEv: 18)</strong> - May lack <code>tsmTs</code>, cloud should generate</li></ol><h3 id=device-identification>Device Identification</h3><ol><li><strong>Wirepas node ID</strong> - Primary identifier in raw CBOR messages</li><li><strong>Serial number lookup</strong> - Map node ID to serial via device database/API</li><li><strong>Use Service API</strong> - Query for complete device details including serial, name, model</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-graphql data-lang=graphql><span style=display:flex><span><span style=color:#204a87;font-weight:700>query</span><span style=color:#f8f8f8> </span><span style=color:#000>DeviceByWirepasNode</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$nodeId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>Int</span><span style=color:#000;font-weight:700>!)</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000>devices</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>where</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>{</span><span style=color:#000>identifiers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>{</span><span style=color:#000>wirepasNodeId</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>{</span><span style=color:#000>_eq</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8> </span><span style=color:#000>$nodeId</span><span style=color:#000;font-weight:700>}}})</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>id</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>name</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>identifiers</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#000>wirepasNodeId</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#000>vendorSerial</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000>deviceType</span><span style=color:#f8f8f8> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>      </span><span style=color:#000>productName</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>    </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8>  </span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8>
</span></span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8>
</span></span></span></code></pre></div><h3 id=error-handling>Error Handling</h3><ol><li><strong>Invalid CBOR</strong> - Malformed binary should be logged and discarded</li><li><strong>Missing required fields</strong> - Validate <code>tsmId</code> and <code>tsmEv</code> presence</li><li><strong>Out-of-range values</strong> - Check multiplier results are reasonable</li><li><strong>Compression errors</strong> - Try non-compressed decode if decompression fails</li></ol><h3 id=performance-optimization>Performance Optimization</h3><ol><li><strong>Batch processing</strong> - Process messages in batches rather than one-by-one</li><li><strong>Cache mappings</strong> - Load CBOR index map once, reuse for all messages</li><li><strong>Parallel decoding</strong> - Use worker threads for high-volume deployments</li><li><strong>Database writes</strong> - Batch inserts for better throughput</li></ol><h2 id=message-id-ranges>Message ID Ranges</h2><p>Message IDs (<code>tsmId</code>) identify the device type and message structure:</p><table><thead><tr><th>Profile ID Range</th><th>Description</th><th>Example Devices</th></tr></thead><tbody><tr><td>1000-1999</td><td>Common profile</td><td>System messages</td></tr><tr><td>12000-12999</td><td>Environment monitoring</td><td>Thingsee ENVIRONMENT</td></tr><tr><td>13000-13999</td><td>Presence and occupancy</td><td>Thingsee PRESENCE</td></tr><tr><td>14000-14999</td><td>Distance measurement</td><td>Thingsee COUNT, Thingsee BEAM</td></tr><tr><td>28000-28999</td><td>Radar-based sensors</td><td>Thingsee RADAR</td></tr></tbody></table><p>Refer to device-specific documentation for complete message ID lists and field definitions.</p><h2 id=troubleshooting>Troubleshooting</h2><h3 id=no-messages-received>No Messages Received</h3><p><strong>Check:</strong></p><ul><li>MQTT subscription includes correct Wirepas endpoint (21/21 for Thingsee CBOR)</li><li>Gateway is connected and forwarding messages</li><li>Sensors are configured with correct network ID and encryption keys</li><li>Default report interval is often 1 hour - wait or configure shorter interval</li></ul><h3 id=cbor-decoding-errors>CBOR Decoding Errors</h3><p><strong>Check:</strong></p><ul><li>Binary payload is complete (not truncated)</li><li>Using correct CBOR library version</li><li>Message might be compressed - try zlib decompression first</li><li>Endpoint 238/238 uses TLV, not CBOR</li></ul><h3 id=incorrect-values-after-conversion>Incorrect Values After Conversion</h3><p><strong>Check:</strong></p><ul><li>Multiplier applied correctly (divide by 10^x, not multiply)</li><li>CBOR index mapping matches device firmware version</li><li>Device-specific indexes (>1000) documented in device manual</li><li>Negative values handled correctly (temperature, acceleration)</li></ul><h3 id=missing-timestamp>Missing Timestamp</h3><p><strong>Check:</strong></p><ul><li>Gateway adding <code>tsmTs</code> from Wirepas time-in-transit</li><li>Network disconnected events (tsmEv: 18) may require cloud-generated timestamp</li><li>Clock synchronization on gateway</li></ul><h3 id=unknown-cbor-indexes>Unknown CBOR Indexes</h3><p><strong>Check:</strong></p><ul><li>Device firmware version - new firmware may add fields</li><li>Device-specific documentation for custom indexes</li><li>Log unknown indexes to identify patterns</li><li>Update decoder mapping table</li></ul><h2 id=related-documentation>Related Documentation</h2><ul><li><a href=../../sensors/thingsee-presence/>Thingsee PRESENCE</a> - Presence sensor message details</li><li><a href=../../../haltian-iot/apis/binary-passthrough/>Binary Passthrough API</a> - Direct CBOR message access</li><li><a href=../../../haltian-iot/apis/service-api/>Service API (GraphQL)</a> - Device identity lookup</li><li><a href=../../../thingsee-iot/api/profiles/>Message Profiles</a> - Profile-specific message definitions</li></ul></div></main></div></div><footer class="td-footer bg-dark"><div class="container py-4"><div class=row><div class="col-12 col-md-6 text-center text-md-left"><div class=td-footer__left><span class=text-white>&copy; 2026 Haltian |
<a href=https://haltian.com/privacy class=text-white>Privacy Policy</a></span></div></div><div class="col-12 col-md-6 text-center text-md-right"><div class=td-footer__right><a class="text-white mx-2" target=_blank rel=noopener href=mailto:support@haltian.com aria-label="Contact Support"><i class="fa fa-envelope"></i>
</a><a class="text-white mx-2" target=_blank rel=noopener href=https://haltian.com aria-label="Haltian Website"><i class="fa fa-globe"></i>
</a><a class="text-white mx-2" target=_blank rel=noopener href=https://github.com/haltian aria-label=GitHub><i class="fab fa-github"></i></a></div></div></div></div></footer></div><script src=https://haltian.github.io/dev-doc-site/js/main.min.8dd4d36f10f64ef5224e04ba313f8e91e183feca404406187e7d4bad9bc83b21.js integrity="sha256-jdTTbxD2TvUiTgS6MT+OkeGD/spARAYYfn1LrZvIOyE=" crossorigin=anonymous></script><script defer src=https://haltian.github.io/dev-doc-site/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=https://haltian.github.io/dev-doc-site/js/tabpane-persist.js></script></body></html>